import{_ as p}from"./_plugin-vue_export-helper.cdc0426e.js";import{o,c as e,d as s,e as n,b as c,a,r as u}from"./app.9b10ba0a.js";const l="/assets/image-20230626205950686.dea01ddb.png",r="/assets/image-20230627181520791.42c8e65c.png",i="/assets/image-20230627192918942.b1205760.png",k="/assets/image-20230627193455859.7bf9c614.png",q="/assets/image-20230627193610072.ec58f78c.png",d="/assets/image-20230627193648879.102ce5f3.png",m="/assets/image-20230627193912335.d0017792.png",v="/assets/image-20230627193947105.a8067e3b.png",y="/assets/image-20230627194153202.c37e6395.png",g="/assets/image-20230627194211918.62c71261.png",b="/assets/image-20230627194230793.63302c42.png",C="/assets/image-20230627194253711.dd118c40.png",h="/assets/image-20230627194345909.025eede3.png",x="/assets/image-20230627194416740.a41696da.png",S="/assets/image-20230627194442947.886ced4c.png",E="/assets/image-20230627194510964.5779ea3f.png",w="/assets/image-20230627194552148.1db603f1.png",_="/assets/image-20230627194622031.4f67f709.png",f="/assets/image-20230627194708190.447d8d55.png",A="/assets/image-20230627194741920.c351c85a.png",L="/assets/image-20230627194801315.d3434b0f.png",T="/assets/image-20230627194820971.00062bcf.png",B="/assets/image-20230627194849357.3f0b1347.png",W="/assets/image-20230627195137728.19ae9b77.png",I="/assets/image-20230627195955795.b626b96d.png",R="/assets/image-20230627200058183.2628d80f.png",F="/assets/image-20230627200140265.e7a33544.png",M="/assets/image-20230627200234314.75416b8e.png",O="/assets/image-20230627200316046.0b212a93.png",N="/assets/image-20230627200352203.e01f6e3c.png",H="/assets/image-20230627200429053.f1c26c98.png",P="/assets/image-20230627200457514.a302a958.png",D="/assets/image-20230627200545987.f0c64932.png",U="/assets/image-20230627200557236.eb2bd5c7.png",K="/assets/image-20230627201039508.35ed6706.png",j="/assets/image-20230627201130057.e6fbe6b4.png",G="/assets/image-20230627201242642.e191ee3c.png",Q="/assets/image-20230627201325524.2a3c8f8f.png",V="/assets/image-20230627201418691.2c057d75.png",J="/assets/image-20230627201435589.b3519d46.png",X="/assets/image-20230627201834801.80887163.png",Z={},Y=a(`<h2 id="一、java-api操作" tabindex="-1"><a class="header-anchor" href="#一、java-api操作" aria-hidden="true">#</a> 一、Java API操作</h2><p>随着 Elasticsearch 8.x 新版本的到来，Type 的概念被废除，为了适应这种数据结构的改变，Elasticsearch 官方从 7.15 版本开始建议使用新的 Elasticsearch Java Client。</p><h3 id="_1-增加依赖关系" tabindex="-1"><a class="header-anchor" href="#_1-增加依赖关系" aria-hidden="true">#</a> 1.增加依赖关系</h3><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>project</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://maven.apache.org/POM/4.0.0<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>modelVersion</span><span class="token punctuation">&gt;</span></span>4.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>modelVersion</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.ragnarok.es8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>elasticsearch-api-8.x<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.0-SNAPSHOT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maven.compiler.source</span><span class="token punctuation">&gt;</span></span>8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maven.compiler.source</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maven.compiler.target</span><span class="token punctuation">&gt;</span></span>8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maven.compiler.target</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>elastic.version</span><span class="token punctuation">&gt;</span></span>8.1.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>elastic.version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.elasticsearch.plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>x-pack-sql-jdbc<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>8.1.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>co.elastic.clients<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>elasticsearch-java<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>\${elastic.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.fasterxml.jackson.core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>jackson-databind<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.12.3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>jakarta.json<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>jakarta.json-api<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.0.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>project</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-获取客户端对象" tabindex="-1"><a class="header-anchor" href="#_2-获取客户端对象" aria-hidden="true">#</a> 2.获取客户端对象</h3><p>就像连接 MySQL 数据库一样，Java 通过客户端操作 Elasticsearch 也要获取到连接后才可以。咱们现在使用的基于 https 安全的 Elasticsearch 服务，所以首先我们需要将之前的证书进行一个转换</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>openssl pkcs12 <span class="token parameter variable">-in</span> elastic-stack-ca.p12 <span class="token parameter variable">-clcerts</span> <span class="token parameter variable">-nokeys</span> <span class="token parameter variable">-out</span> java-ca.crt
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="`+l+`" alt="image-20230626205950686"></p><p>配置证书后，我们就可以采用 https 方式获取连接对象了。</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>ragnarok<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>api</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">co<span class="token punctuation">.</span>elastic<span class="token punctuation">.</span>clients<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">co<span class="token punctuation">.</span>elastic<span class="token punctuation">.</span>clients<span class="token punctuation">.</span>json<span class="token punctuation">.</span>jackson<span class="token punctuation">.</span></span><span class="token class-name">JacksonJsonpMapper</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">co<span class="token punctuation">.</span>elastic<span class="token punctuation">.</span>clients<span class="token punctuation">.</span>transport<span class="token punctuation">.</span></span><span class="token class-name">ElasticsearchTransport</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">co<span class="token punctuation">.</span>elastic<span class="token punctuation">.</span>clients<span class="token punctuation">.</span>transport<span class="token punctuation">.</span>rest_client<span class="token punctuation">.</span></span><span class="token class-name">RestClientTransport</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpHost</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>http<span class="token punctuation">.</span>auth<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>http<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>http<span class="token punctuation">.</span>conn<span class="token punctuation">.</span>ssl<span class="token punctuation">.</span></span><span class="token class-name">NoopHostnameVerifier</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>http<span class="token punctuation">.</span>impl<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>http<span class="token punctuation">.</span>impl<span class="token punctuation">.</span>nio<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">HttpAsyncClientBuilder</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>http<span class="token punctuation">.</span>ssl<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>net<span class="token punctuation">.</span>ssl<span class="token punctuation">.</span></span><span class="token class-name">SSLContext</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">InputStream</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>nio<span class="token punctuation">.</span>file<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>security<span class="token punctuation">.</span></span><span class="token class-name">KeyStore</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>security<span class="token punctuation">.</span>cert<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * <span class="token keyword">@author</span> ragnarok
 * <span class="token keyword">@version</span> 1.0
 * <span class="token keyword">@description</span> ES客户端连接
 * <span class="token keyword">@create</span> 2023-06-27 12:24
 * <span class="token keyword">@github</span> https://github.com/Ragnarokoo
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ESClient</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span>
    <span class="token punctuation">{</span>
        <span class="token function">initESConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
    * <span class="token keyword">@author</span>: ragnarok
    * <span class="token keyword">@description</span>: 初始化ES连接
    * <span class="token keyword">@param</span>: []
    * <span class="token keyword">@return</span>: void
    * <span class="token keyword">@date</span>: 2023/6/27 12:33
    */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">initESConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span>
    <span class="token punctuation">{</span>
        <span class="token comment">// 获取客户端对象</span>
        <span class="token keyword">final</span> <span class="token class-name">CredentialsProvider</span> credentialsProvider <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BasicCredentialsProvider</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        credentialsProvider<span class="token punctuation">.</span><span class="token function">setCredentials</span><span class="token punctuation">(</span><span class="token class-name">AuthScope</span><span class="token punctuation">.</span><span class="token constant">ANY</span><span class="token punctuation">,</span>
                <span class="token keyword">new</span> <span class="token class-name">UsernamePasswordCredentials</span><span class="token punctuation">(</span><span class="token string">&quot;elastic&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;CPz+1m4DlutB+xWFou=r&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Path</span> caCertificatePath <span class="token operator">=</span> <span class="token class-name">Paths</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/Users/mac/Desktop/Elasticsearch-study/elasticsearch-api-8.x/certs/java-ca.crt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">CertificateFactory</span> factory <span class="token operator">=</span>
                <span class="token class-name">CertificateFactory</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">&quot;X.509&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Certificate</span> trustedCa<span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">(</span><span class="token class-name">InputStream</span> is <span class="token operator">=</span> <span class="token class-name">Files</span><span class="token punctuation">.</span><span class="token function">newInputStream</span><span class="token punctuation">(</span>caCertificatePath<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            trustedCa <span class="token operator">=</span> factory<span class="token punctuation">.</span><span class="token function">generateCertificate</span><span class="token punctuation">(</span>is<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">KeyStore</span> trustStore <span class="token operator">=</span> <span class="token class-name">KeyStore</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">&quot;pkcs12&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        trustStore<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        trustStore<span class="token punctuation">.</span><span class="token function">setCertificateEntry</span><span class="token punctuation">(</span><span class="token string">&quot;ca&quot;</span><span class="token punctuation">,</span> trustedCa<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">SSLContextBuilder</span> sslContextBuilder <span class="token operator">=</span> <span class="token class-name">SSLContexts</span><span class="token punctuation">.</span><span class="token function">custom</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">loadTrustMaterial</span><span class="token punctuation">(</span>trustStore<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">final</span> <span class="token class-name">SSLContext</span> sslContext <span class="token operator">=</span> sslContextBuilder<span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">RestClientBuilder</span> builder <span class="token operator">=</span> <span class="token class-name">RestClient</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span>
                        <span class="token keyword">new</span> <span class="token class-name">HttpHost</span><span class="token punctuation">(</span><span class="token string">&quot;172.16.102.135&quot;</span><span class="token punctuation">,</span> <span class="token number">9200</span><span class="token punctuation">,</span> <span class="token string">&quot;https&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setHttpClientConfigCallback</span><span class="token punctuation">(</span><span class="token keyword">new</span>
                                                     <span class="token class-name">RestClientBuilder<span class="token punctuation">.</span>HttpClientConfigCallback</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                                                         <span class="token annotation punctuation">@Override</span>
                                                         <span class="token keyword">public</span> <span class="token class-name">HttpAsyncClientBuilder</span> <span class="token function">customizeHttpClient</span><span class="token punctuation">(</span>
                                                                 <span class="token class-name">HttpAsyncClientBuilder</span> httpClientBuilder<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                                                             <span class="token keyword">return</span> httpClientBuilder<span class="token punctuation">.</span><span class="token function">setSSLContext</span><span class="token punctuation">(</span>sslContext<span class="token punctuation">)</span>
                                                                     <span class="token punctuation">.</span><span class="token function">setSSLHostnameVerifier</span><span class="token punctuation">(</span><span class="token class-name">NoopHostnameVerifier</span><span class="token punctuation">.</span><span class="token constant">INSTANCE</span><span class="token punctuation">)</span>
                                                                     <span class="token punctuation">.</span><span class="token function">setDefaultCredentialsProvider</span><span class="token punctuation">(</span>credentialsProvider<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                                         <span class="token punctuation">}</span>
                                                     <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">RestClient</span> restClient <span class="token operator">=</span> builder<span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ElasticsearchTransport</span> transport <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RestClientTransport</span><span class="token punctuation">(</span>
                restClient<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">JacksonJsonpMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 同步客户端对象</span>
        <span class="token class-name">ElasticsearchClient</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ElasticsearchClient</span><span class="token punctuation">(</span>transport<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 异步客户端对象</span>
        <span class="token class-name">ElasticsearchAsyncClient</span> asyncClient <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ElasticsearchAsyncClient</span><span class="token punctuation">(</span>transport<span class="token punctuation">)</span><span class="token punctuation">;</span>

        transport<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-操作数据" tabindex="-1"><a class="header-anchor" href="#_3-操作数据" aria-hidden="true">#</a> 3.操作数据</h3><blockquote><p>索引操作</p></blockquote><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>ragnarok<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>api</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">co<span class="token punctuation">.</span>elastic<span class="token punctuation">.</span>clients<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">co<span class="token punctuation">.</span>elastic<span class="token punctuation">.</span>clients<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>indices<span class="token punctuation">.</span></span><span class="token class-name">CreateIndexRequest</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">co<span class="token punctuation">.</span>elastic<span class="token punctuation">.</span>clients<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>indices<span class="token punctuation">.</span></span><span class="token class-name">CreateIndexResponse</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">co<span class="token punctuation">.</span>elastic<span class="token punctuation">.</span>clients<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>indices<span class="token punctuation">.</span></span><span class="token class-name">DeleteIndexRequest</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">co<span class="token punctuation">.</span>elastic<span class="token punctuation">.</span>clients<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>indices<span class="token punctuation">.</span></span><span class="token class-name">DeleteIndexResponse</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">co<span class="token punctuation">.</span>elastic<span class="token punctuation">.</span>clients<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>indices<span class="token punctuation">.</span></span><span class="token class-name">ElasticsearchIndicesClient</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">co<span class="token punctuation">.</span>elastic<span class="token punctuation">.</span>clients<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>indices<span class="token punctuation">.</span></span><span class="token class-name">ExistsRequest</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">co<span class="token punctuation">.</span>elastic<span class="token punctuation">.</span>clients<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>indices<span class="token punctuation">.</span></span><span class="token class-name">GetIndexRequest</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">co<span class="token punctuation">.</span>elastic<span class="token punctuation">.</span>clients<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>indices<span class="token punctuation">.</span></span><span class="token class-name">GetIndexResponse</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">co<span class="token punctuation">.</span>elastic<span class="token punctuation">.</span>clients<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>indices<span class="token punctuation">.</span></span><span class="token class-name">IndexState</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">co<span class="token punctuation">.</span>elastic<span class="token punctuation">.</span>clients<span class="token punctuation">.</span>json<span class="token punctuation">.</span>jackson<span class="token punctuation">.</span></span><span class="token class-name">JacksonJsonpMapper</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">co<span class="token punctuation">.</span>elastic<span class="token punctuation">.</span>clients<span class="token punctuation">.</span>transport<span class="token punctuation">.</span></span><span class="token class-name">ElasticsearchTransport</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">co<span class="token punctuation">.</span>elastic<span class="token punctuation">.</span>clients<span class="token punctuation">.</span>transport<span class="token punctuation">.</span>rest_client<span class="token punctuation">.</span></span><span class="token class-name">RestClientTransport</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpHost</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>http<span class="token punctuation">.</span>auth<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>http<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>http<span class="token punctuation">.</span>conn<span class="token punctuation">.</span>ssl<span class="token punctuation">.</span></span><span class="token class-name">NoopHostnameVerifier</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>http<span class="token punctuation">.</span>impl<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>http<span class="token punctuation">.</span>impl<span class="token punctuation">.</span>nio<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">HttpAsyncClientBuilder</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>http<span class="token punctuation">.</span>ssl<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>elasticsearch<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>net<span class="token punctuation">.</span>ssl<span class="token punctuation">.</span></span><span class="token class-name">SSLContext</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">InputStream</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>nio<span class="token punctuation">.</span>file<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>security<span class="token punctuation">.</span></span><span class="token class-name">KeyStore</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>security<span class="token punctuation">.</span>cert<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * <span class="token keyword">@author</span> ragnarok
 * <span class="token keyword">@version</span> 1.0
 * <span class="token keyword">@description</span> ES客户端连接
 * <span class="token keyword">@create</span> 2023-06-27 12:24
 * <span class="token keyword">@github</span> https://github.com/Ragnarokoo
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ESClient</span>
<span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">ElasticsearchClient</span> client<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">ElasticsearchAsyncClient</span> asyncClient<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">ElasticsearchTransport</span> transport<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">INDEX_ATGUIGU</span> <span class="token operator">=</span> <span class="token string">&quot;atguigu&quot;</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span>
    <span class="token punctuation">{</span>
        <span class="token comment">// 初始化ES服务器的连接</span>
        <span class="token function">initESConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 操作索引</span>
        <span class="token function">operationIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">operationIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span>
    <span class="token punctuation">{</span>
        <span class="token comment">// 获取索引客户端对象</span>
        <span class="token keyword">final</span> <span class="token class-name">ElasticsearchIndicesClient</span> indices <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">indices</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 判断索引是否存在</span>
        <span class="token class-name">ExistsRequest</span> existsRequest <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ExistsRequest<span class="token punctuation">.</span>Builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span><span class="token constant">INDEX_ATGUIGU</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">final</span> <span class="token keyword">boolean</span> flag <span class="token operator">=</span> indices<span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span>existsRequest<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>flag<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;索引&quot;</span> <span class="token operator">+</span> <span class="token constant">INDEX_ATGUIGU</span> <span class="token operator">+</span> <span class="token string">&quot;已经存在&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token comment">// 创建索引</span>
            <span class="token comment">// 需要采用构建方式来构建对象,ESAPI的对象基本上都是采用这种方式</span>
            <span class="token class-name">CreateIndexRequest</span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CreateIndexRequest<span class="token punctuation">.</span>Builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span><span class="token constant">INDEX_ATGUIGU</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">final</span> <span class="token class-name">CreateIndexResponse</span> createIndexResponse <span class="token operator">=</span> indices<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;创建索引的响应对象 = &quot;</span> <span class="token operator">+</span> createIndexResponse<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// 查询索引</span>
        <span class="token class-name">GetIndexRequest</span> getIndexRequest <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GetIndexRequest<span class="token punctuation">.</span>Builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span><span class="token constant">INDEX_ATGUIGU</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">final</span> <span class="token class-name">GetIndexResponse</span> getIndexResponse <span class="token operator">=</span> indices<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>getIndexRequest<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//final IndexState state = getIndexResponse.get(&quot;atguigu&quot;);</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;查询的相应结果 = &quot;</span> <span class="token operator">+</span> getIndexResponse<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 删除索引</span>
        <span class="token class-name">DeleteIndexRequest</span> deleteIndexRequest <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DeleteIndexRequest<span class="token punctuation">.</span>Builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span><span class="token constant">INDEX_ATGUIGU</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">DeleteIndexResponse</span> delete <span class="token operator">=</span> indices<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>deleteIndexRequest<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;删除索引成功: &quot;</span> <span class="token operator">+</span> delete<span class="token punctuation">.</span><span class="token function">acknowledged</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        transport<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * <span class="token keyword">@author</span>: ragnarok
     * <span class="token keyword">@description</span>: 初始化ES连接
     * <span class="token keyword">@param</span>: []
     * <span class="token keyword">@return</span>: void
     * <span class="token keyword">@date</span>: 2023/6/27 12:33
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">initESConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span>
    <span class="token punctuation">{</span>
        <span class="token comment">// 获取客户端对象</span>
        <span class="token keyword">final</span> <span class="token class-name">CredentialsProvider</span> credentialsProvider <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BasicCredentialsProvider</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        credentialsProvider<span class="token punctuation">.</span><span class="token function">setCredentials</span><span class="token punctuation">(</span><span class="token class-name">AuthScope</span><span class="token punctuation">.</span><span class="token constant">ANY</span><span class="token punctuation">,</span>
                <span class="token keyword">new</span> <span class="token class-name">UsernamePasswordCredentials</span><span class="token punctuation">(</span><span class="token string">&quot;elastic&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;CPz+1m4DlutB+xWFou=r&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Path</span> caCertificatePath <span class="token operator">=</span> <span class="token class-name">Paths</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/Users/mac/Desktop/Elasticsearch-study/elasticsearch-api-8.x/certs/java-ca.crt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">CertificateFactory</span> factory <span class="token operator">=</span>
                <span class="token class-name">CertificateFactory</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">&quot;X.509&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Certificate</span> trustedCa<span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">(</span><span class="token class-name">InputStream</span> is <span class="token operator">=</span> <span class="token class-name">Files</span><span class="token punctuation">.</span><span class="token function">newInputStream</span><span class="token punctuation">(</span>caCertificatePath<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            trustedCa <span class="token operator">=</span> factory<span class="token punctuation">.</span><span class="token function">generateCertificate</span><span class="token punctuation">(</span>is<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">KeyStore</span> trustStore <span class="token operator">=</span> <span class="token class-name">KeyStore</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">&quot;pkcs12&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        trustStore<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        trustStore<span class="token punctuation">.</span><span class="token function">setCertificateEntry</span><span class="token punctuation">(</span><span class="token string">&quot;ca&quot;</span><span class="token punctuation">,</span> trustedCa<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">SSLContextBuilder</span> sslContextBuilder <span class="token operator">=</span> <span class="token class-name">SSLContexts</span><span class="token punctuation">.</span><span class="token function">custom</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">loadTrustMaterial</span><span class="token punctuation">(</span>trustStore<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">final</span> <span class="token class-name">SSLContext</span> sslContext <span class="token operator">=</span> sslContextBuilder<span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">RestClientBuilder</span> builder <span class="token operator">=</span> <span class="token class-name">RestClient</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span>
                        <span class="token keyword">new</span> <span class="token class-name">HttpHost</span><span class="token punctuation">(</span><span class="token string">&quot;172.16.102.135&quot;</span><span class="token punctuation">,</span> <span class="token number">9200</span><span class="token punctuation">,</span> <span class="token string">&quot;https&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setHttpClientConfigCallback</span><span class="token punctuation">(</span><span class="token keyword">new</span>
                                                     <span class="token class-name">RestClientBuilder<span class="token punctuation">.</span>HttpClientConfigCallback</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                                                     <span class="token punctuation">{</span>
                                                         <span class="token annotation punctuation">@Override</span>
                                                         <span class="token keyword">public</span> <span class="token class-name">HttpAsyncClientBuilder</span> <span class="token function">customizeHttpClient</span><span class="token punctuation">(</span>
                                                                 <span class="token class-name">HttpAsyncClientBuilder</span> httpClientBuilder<span class="token punctuation">)</span>
                                                         <span class="token punctuation">{</span>
                                                             <span class="token keyword">return</span> httpClientBuilder<span class="token punctuation">.</span><span class="token function">setSSLContext</span><span class="token punctuation">(</span>sslContext<span class="token punctuation">)</span>
                                                                     <span class="token punctuation">.</span><span class="token function">setSSLHostnameVerifier</span><span class="token punctuation">(</span><span class="token class-name">NoopHostnameVerifier</span><span class="token punctuation">.</span><span class="token constant">INSTANCE</span><span class="token punctuation">)</span>
                                                                     <span class="token punctuation">.</span><span class="token function">setDefaultCredentialsProvider</span><span class="token punctuation">(</span>credentialsProvider<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                                         <span class="token punctuation">}</span>
                                                     <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">RestClient</span> restClient <span class="token operator">=</span> builder<span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        transport <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RestClientTransport</span><span class="token punctuation">(</span>
                restClient<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">JacksonJsonpMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 同步客户端对象</span>
        client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ElasticsearchClient</span><span class="token punctuation">(</span>transport<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 异步客户端对象</span>
        asyncClient <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ElasticsearchAsyncClient</span><span class="token punctuation">(</span>transport<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//transport.close();</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>进阶写法（改写为Lambda表达式）</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">operationIndexLambda</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span>
    <span class="token punctuation">{</span>
        <span class="token comment">// 获取索引客户端对象</span>
        <span class="token keyword">final</span> <span class="token class-name">ElasticsearchIndicesClient</span> indices <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">indices</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">final</span> <span class="token keyword">boolean</span> flag <span class="token operator">=</span> indices<span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span>req <span class="token operator">-&gt;</span> req<span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span><span class="token constant">INDEX_ATGUIGU</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>flag<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;索引&quot;</span> <span class="token operator">+</span> <span class="token constant">INDEX_ATGUIGU</span> <span class="token operator">+</span> <span class="token string">&quot;已经存在&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token comment">// 创建索引</span>
            <span class="token comment">// 需要采用构建方式来构建对象,ESAPI的对象基本上都是采用这种方式</span>
            <span class="token keyword">final</span> <span class="token class-name">CreateIndexResponse</span> createIndexResponse <span class="token operator">=</span> indices<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>req <span class="token operator">-&gt;</span> req<span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span><span class="token constant">INDEX_ATGUIGU</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;创建索引的响应对象 = &quot;</span> <span class="token operator">+</span> createIndexResponse<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// 查询索引</span>
        indices<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>req<span class="token operator">-&gt;</span> req<span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span><span class="token constant">INDEX_ATGUIGU</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;atguigu&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 删除索引</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>indices<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>req <span class="token operator">-&gt;</span> req<span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span><span class="token constant">INDEX_ATGUIGU</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">acknowledged</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        transport<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>文档操作</p></blockquote><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">operationDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span>
    <span class="token punctuation">{</span>
        <span class="token class-name">User</span> user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        user<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        user<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">&quot;zhangsan&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        user<span class="token punctuation">.</span><span class="token function">setAge</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token class-name">CreateRequest</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> createRequest <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CreateRequest<span class="token punctuation">.</span>Builder</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span><span class="token constant">INDEX_ATGUIGU</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token string">&quot;1001&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">document</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 增加文档</span>
        <span class="token comment">/*final CreateResponse createResponse = client.create(createRequest);
        System.out.println(&quot;文档创建的响应对象:&quot; + createResponse);*/</span>

        <span class="token comment">// 批量添加数据</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">BulkOperation</span><span class="token punctuation">&gt;</span></span> opts <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">5</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">CreateOperation</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> optObj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CreateOperation<span class="token punctuation">.</span>Builder</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span><span class="token constant">INDEX_ATGUIGU</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token string">&quot;200&quot;</span> <span class="token operator">+</span> i<span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">document</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token number">2000</span> <span class="token operator">+</span> i<span class="token punctuation">,</span> <span class="token string">&quot;zhangsan&quot;</span> <span class="token operator">+</span> i<span class="token punctuation">,</span> <span class="token number">30</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">BulkOperation</span> opt <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BulkOperation<span class="token punctuation">.</span>Builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>optObj<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            opts<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>opt<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token class-name">BulkRequest</span> bulkRequest <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BulkRequest<span class="token punctuation">.</span>Builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">operations</span><span class="token punctuation">(</span>opts<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//final BulkResponse bulk = client.bulk(bulkRequest);</span>
        <span class="token comment">//System.out.println(&quot;批量新增数据的响应:&quot; + bulk);</span>

        <span class="token comment">// 文档的删除</span>
        <span class="token class-name">DeleteRequest</span> deleteRequest <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DeleteRequest<span class="token punctuation">.</span>Builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span><span class="token constant">INDEX_ATGUIGU</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token string">&quot;2001&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">DeleteResponse</span> delete <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>deleteRequest<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>delete<span class="token punctuation">)</span><span class="token punctuation">;</span>

        transport<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>进阶改造（Lambda版本）</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">operationDocumentLambda</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span>
    <span class="token punctuation">{</span>
        <span class="token class-name">User</span> user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        user<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        user<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">&quot;zhangsan&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        user<span class="token punctuation">.</span><span class="token function">setAge</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>client<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>
                        req <span class="token operator">-&gt;</span>
                                req<span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span><span class="token constant">INDEX_ATGUIGU</span><span class="token punctuation">)</span>
                                        <span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token string">&quot;1001&quot;</span><span class="token punctuation">)</span>
                                        <span class="token punctuation">.</span><span class="token function">document</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token string">&quot;zhangsan&quot;</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">result</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> users <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">5</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            users<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token number">3000</span> <span class="token operator">+</span> i<span class="token punctuation">,</span> <span class="token string">&quot;lisi&quot;</span> <span class="token operator">+</span> i<span class="token punctuation">,</span> <span class="token number">30</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 批量添加数据</span>
        client<span class="token punctuation">.</span><span class="token function">bulk</span><span class="token punctuation">(</span>
                req <span class="token operator">-&gt;</span>
                <span class="token punctuation">{</span>
                    users<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>
                            u <span class="token operator">-&gt;</span>
                            <span class="token punctuation">{</span>
                                req<span class="token punctuation">.</span><span class="token function">operations</span><span class="token punctuation">(</span>
                                        b <span class="token operator">-&gt;</span> b<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>
                                                d <span class="token operator">-&gt;</span>
                                                        d<span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span><span class="token constant">INDEX_ATGUIGU</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span>u<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">document</span><span class="token punctuation">(</span>u<span class="token punctuation">)</span>
                                        <span class="token punctuation">)</span>
                                <span class="token punctuation">)</span><span class="token punctuation">;</span>
                            <span class="token punctuation">}</span>
                    <span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">return</span> req<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 文档的删除</span>
        client<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>req <span class="token operator">-&gt;</span> req<span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span><span class="token constant">INDEX_ATGUIGU</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token string">&quot;3001&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        transport<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>文档查询</p></blockquote><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">queryDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span>
    <span class="token punctuation">{</span>
        <span class="token class-name">MatchQuery</span> matchQuery <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MatchQuery<span class="token punctuation">.</span>Builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">field</span><span class="token punctuation">(</span><span class="token string">&quot;age&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Query</span> query <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Query<span class="token punctuation">.</span>Builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>matchQuery<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">SearchRequest</span> searchRequest <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SearchRequest<span class="token punctuation">.</span>Builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">SearchResponse</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> searchResponse <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span>searchRequest<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;searchResponse = &quot;</span> <span class="token operator">+</span> searchResponse<span class="token punctuation">)</span><span class="token punctuation">;</span>

        transport<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>进阶改造（Lambda表达式）</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">queryDocumentLambda</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span>
    <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>client<span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span>
                req <span class="token operator">-&gt;</span>
                <span class="token punctuation">{</span>
                    req<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>
                            q <span class="token operator">-&gt;</span> q<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>
                                    m <span class="token operator">-&gt;</span> m<span class="token punctuation">.</span><span class="token function">field</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token string">&quot;zhangsan&quot;</span><span class="token punctuation">)</span>
                            <span class="token punctuation">)</span>
                    <span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">return</span> req<span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token keyword">class</span>
        <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hits</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        transport<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-异步客户端操作" tabindex="-1"><a class="header-anchor" href="#_4-异步客户端操作" aria-hidden="true">#</a> 4.异步客户端操作</h3><p>ES Java API 提供了同步和异步的两种客户端处理。之前演示的都是同步处理，异步客户端的处理和同步客户端处理的 API 基本原理相同，不同的是需要异步对返回结果进行相应的处理。</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">asyncClientOperation</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span>
    <span class="token punctuation">{</span>
        asyncClient<span class="token punctuation">.</span><span class="token function">indices</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>
                req<span class="token operator">-&gt;</span> req<span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span><span class="token string">&quot;newindex&quot;</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">whenComplete</span><span class="token punctuation">(</span>
                <span class="token punctuation">(</span><span class="token class-name">Response</span><span class="token punctuation">,</span>error<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
                    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;回调方法&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">Response</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Response</span><span class="token punctuation">.</span><span class="token function">acknowledged</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                        error<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;主线程代码....&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">asyncClientOperation</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span>
    <span class="token punctuation">{</span>
        asyncClient<span class="token punctuation">.</span><span class="token function">indices</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>
                req<span class="token operator">-&gt;</span> req<span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span><span class="token string">&quot;newindex&quot;</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">thenApply</span><span class="token punctuation">(</span>
                resp<span class="token operator">-&gt;</span>resp<span class="token punctuation">.</span><span class="token function">acknowledged</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">whenComplete</span><span class="token punctuation">(</span>
                <span class="token punctuation">(</span>resp<span class="token punctuation">,</span>error<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
                    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;回调方法&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>resp<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>resp<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                        error<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;主线程代码....&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="二、eql操作" tabindex="-1"><a class="header-anchor" href="#二、eql操作" aria-hidden="true">#</a> 二、EQL操作</h2><p>EQL 的全名是 Event Query Language (EQL)。事件查询语言（EQL）是一种用于基于事件的时间序列数据（例如日志，指标和跟踪）的查询语言。在 Elastic Security 平台上，当输入有效的 EQL 时，查询会在数据节点上编译，执行查询并返回结果。这一切都快速、并行地发生，让用户立即看到结果。</p><p>EQL 的优点：</p><ul><li>EQL 使你可以表达事件之间的关系</li></ul><p>许多查询语言允许您匹配单个事件。EQL 使你可以匹配不同事件类别和时间跨度的一系列事件。</p><ul><li>EQL 的学习曲线很低</li></ul><p>EQL 语法看起来像其他常见查询语言，例如 SQL。 EQL 使你可以直观地编写和读取查询，从而可以进行快速，迭代的搜索。</p><ul><li>EQL 设计用于安全用例</li></ul><p>尽管你可以将其用于任何基于事件的数据，但我们创建了 EQL 来进行威胁搜寻。 EQL不仅支持危害指标（IOC）搜索，而且可以描述超出 IOC 范围的活动。</p><p><img src="`+r+`" alt="image-20230627181520791"></p><h3 id="基础语法" tabindex="-1"><a class="header-anchor" href="#基础语法" aria-hidden="true">#</a> 基础语法</h3><h4 id="数据准备" tabindex="-1"><a class="header-anchor" href="#数据准备" aria-hidden="true">#</a> 数据准备</h4><p>要运行 EQL 搜索，搜索到的数据流或索引必须包含时间戳和事件类别字段。 默认情况下，EQL 使用 Elastic 通用模式（ECS）中的 @timestamp 和 event.category 字段。</p><p>@timestamp 表示时间戳，event.category 表示事件分类。</p><p>咱们准备一些简单的数据,用于表示电商网站页面跳转</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># 创建索引</span>
PUT /gmall

<span class="token comment"># 批量增加数据</span>
PUT _bulk
<span class="token punctuation">{</span><span class="token string">&quot;index&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;_index&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;gmall&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">&quot;@timestamp&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;2022-06-01T12:00:00.00+08:00&quot;</span>, <span class="token string">&quot;event&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;category&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;page&quot;</span><span class="token punctuation">}</span>,<span class="token string">&quot;page&quot;</span> <span class="token builtin class-name">:</span> <span class="token punctuation">{</span><span class="token string">&quot;session_id&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;42FC7E13-CB3E-5C05-0000-0010A0125101&quot;</span>,<span class="token string">&quot;last_page_id&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>,<span class="token string">&quot;page_id&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;login&quot;</span>,<span class="token string">&quot;user_id&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">&quot;index&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;_index&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;gmall&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">&quot;@timestamp&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;2022-06-01T12:01:00.00+08:00&quot;</span>, <span class="token string">&quot;event&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;category&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;page&quot;</span><span class="token punctuation">}</span>,<span class="token string">&quot;page&quot;</span> <span class="token builtin class-name">:</span> <span class="token punctuation">{</span><span class="token string">&quot;session_id&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;42FC7E13-CB3E-5C05-0000-0010A0125101&quot;</span>,<span class="token string">&quot;last_page_id&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;login&quot;</span>,<span class="token string">&quot;page_id&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;good_list&quot;</span>,<span class="token string">&quot;user_id&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">&quot;index&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;_index&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;gmall&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">&quot;@timestamp&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;2022-06-01T12:05:00.00+08:00&quot;</span>, <span class="token string">&quot;event&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;category&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;page&quot;</span><span class="token punctuation">}</span>,<span class="token string">&quot;page&quot;</span> <span class="token builtin class-name">:</span> <span class="token punctuation">{</span><span class="token string">&quot;session_id&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;42FC7E13-CB3E-5C05-0000-0010A0125101&quot;</span>,<span class="token string">&quot;last_page_id&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;good_list&quot;</span>,<span class="token string">&quot;page_id&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;good_detail&quot;</span>,<span class="token string">&quot;user_id&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">&quot;index&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;_index&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;gmall&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">&quot;@timestamp&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;2022-06-01T12:07:00.00+08:00&quot;</span>, <span class="token string">&quot;event&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;category&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;page&quot;</span><span class="token punctuation">}</span>,<span class="token string">&quot;page&quot;</span> <span class="token builtin class-name">:</span> <span class="token punctuation">{</span><span class="token string">&quot;session_id&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;42FC7E13-CB3E-5C05-0000-0010A0125101&quot;</span>,<span class="token string">&quot;last_page_id&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;good_detail&quot;</span>,<span class="token string">&quot;page_id&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;order&quot;</span>,<span class="token string">&quot;user_id&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">&quot;index&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;_index&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;gmall&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">&quot;@timestamp&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;2022-06-01T12:08:00.00+08:00&quot;</span>, <span class="token string">&quot;event&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;category&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;page&quot;</span><span class="token punctuation">}</span>,<span class="token string">&quot;page&quot;</span> <span class="token builtin class-name">:</span> <span class="token punctuation">{</span><span class="token string">&quot;session_id&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;42FC7E13-CB3E-5C05-0000-0010A0125101&quot;</span>,<span class="token string">&quot;last_page_id&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;order&quot;</span>,<span class="token string">&quot;page_id&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;payment&quot;</span>,<span class="token string">&quot;user_id&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">&quot;index&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;_index&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;gmall&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">&quot;@timestamp&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;2022-06-01T12:08:00.00+08:00&quot;</span>, <span class="token string">&quot;event&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;category&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;page&quot;</span><span class="token punctuation">}</span>,<span class="token string">&quot;page&quot;</span> <span class="token builtin class-name">:</span> <span class="token punctuation">{</span><span class="token string">&quot;session_id&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;42FC7E13-CB3E-5C05-0000-0010A0125102&quot;</span>,<span class="token string">&quot;last_page_id&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>,<span class="token string">&quot;page_id&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;login&quot;</span>,<span class="token string">&quot;user_id&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;2&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">&quot;index&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;_index&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;gmall&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">&quot;@timestamp&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;2022-06-01T12:08:00.00+08:00&quot;</span>, <span class="token string">&quot;event&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;category&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;page&quot;</span><span class="token punctuation">}</span>,<span class="token string">&quot;page&quot;</span> <span class="token builtin class-name">:</span> <span class="token punctuation">{</span><span class="token string">&quot;session_id&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;42FC7E13-CB3E-5C05-0000-0010A0125102&quot;</span>,<span class="token string">&quot;last_page_id&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;login&quot;</span>,<span class="token string">&quot;page_id&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;payment&quot;</span>,<span class="token string">&quot;user_id&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;2&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="数据窗口搜索" tabindex="-1"><a class="header-anchor" href="#数据窗口搜索" aria-hidden="true">#</a> 数据窗口搜索</h4><p>在事件响应过程中，有很多时候，了解特定时间发生的所有事件是很有用的。使用一种名为any 的特殊事件类型，针对所有事件进行匹配，如果想要匹配特定事件，就需要指明事件分类名称</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>GET /gmall/_eql/search
<span class="token punctuation">{</span>
 <span class="token string">&quot;query&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>&quot;
 any where page.user_id <span class="token operator">==</span> <span class="token string">&quot;1&quot;</span>
 <span class="token string">&quot;&quot;</span>&quot;
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>查询结果：</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;is_partial&quot;</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">&quot;is_running&quot;</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">&quot;took&quot;</span> <span class="token operator">:</span> <span class="token number">511</span><span class="token punctuation">,</span>
  <span class="token property">&quot;timed_out&quot;</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">&quot;hits&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;total&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;value&quot;</span> <span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
      <span class="token property">&quot;relation&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;eq&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;events&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;_index&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;gmall&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;6R14_IgBCaaR_R-J16ZD&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;_source&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;@timestamp&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;2022-06-01T12:01:00.00+08:00&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;event&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;category&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;page&quot;</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token property">&quot;page&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;session_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;42FC7E13-CB3E-5C05-0000-0010A0125101&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;last_page_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;login&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;page_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;good_list&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;user_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;1&quot;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;_index&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;gmall&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;6h14_IgBCaaR_R-J16ZD&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;_source&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;@timestamp&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;2022-06-01T12:05:00.00+08:00&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;event&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;category&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;page&quot;</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token property">&quot;page&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;session_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;42FC7E13-CB3E-5C05-0000-0010A0125101&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;last_page_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;good_list&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;page_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;good_detail&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;user_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;1&quot;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;_index&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;gmall&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;6x14_IgBCaaR_R-J16ZD&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;_source&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;@timestamp&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;2022-06-01T12:07:00.00+08:00&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;event&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;category&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;page&quot;</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token property">&quot;page&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;session_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;42FC7E13-CB3E-5C05-0000-0010A0125101&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;last_page_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;good_detail&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;page_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;order&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;user_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;1&quot;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;_index&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;gmall&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;7B14_IgBCaaR_R-J16ZD&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;_source&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;@timestamp&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;2022-06-01T12:08:00.00+08:00&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;event&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;category&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;page&quot;</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token property">&quot;page&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;session_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;42FC7E13-CB3E-5C05-0000-0010A0125101&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;last_page_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;order&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;page_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;payment&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;user_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;1&quot;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="统计符合条件" tabindex="-1"><a class="header-anchor" href="#统计符合条件" aria-hidden="true">#</a> 统计符合条件</h4><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>GET /gmall/_eql/search
<span class="token punctuation">{</span>
  <span class="token string">&quot;query&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>&quot;
 any where <span class="token boolean">true</span>
 <span class="token string">&quot;&quot;</span>&quot;,
  <span class="token string">&quot;filter&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;range&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
      <span class="token string">&quot;@timestamp&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;gte&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;1654056000000&quot;</span>,
        <span class="token string">&quot;lt&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;1654056005000&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>查询结果：</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;is_partial&quot;</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">&quot;is_running&quot;</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">&quot;took&quot;</span> <span class="token operator">:</span> <span class="token number">133</span><span class="token punctuation">,</span>
  <span class="token property">&quot;timed_out&quot;</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">&quot;hits&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;total&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;value&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
      <span class="token property">&quot;relation&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;eq&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;events&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;_index&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;gmall&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;6B14_IgBCaaR_R-J1qan&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;_source&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;@timestamp&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;2022-06-01T12:00:00.00+08:00&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;event&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;category&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;page&quot;</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token property">&quot;page&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;session_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;42FC7E13-CB3E-5C05-0000-0010A0125101&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;last_page_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;page_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;login&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;user_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;&quot;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="事件序列" tabindex="-1"><a class="header-anchor" href="#事件序列" aria-hidden="true">#</a> 事件序列</h4><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># 页面先访问 login,后面又访问了 good_detail 的页面</span>
GET /gmall/_eql/search
<span class="token punctuation">{</span>
  <span class="token string">&quot;query&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>&quot;
   sequence by page.session_id
   <span class="token punctuation">[</span>page where <span class="token assign-left variable">page.page_id</span><span class="token operator">==</span><span class="token string">&quot;login&quot;</span><span class="token punctuation">]</span>
   <span class="token punctuation">[</span>page where <span class="token assign-left variable">page.page_id</span><span class="token operator">==</span><span class="token string">&quot;good_detail&quot;</span><span class="token punctuation">]</span>
 <span class="token string">&quot;&quot;</span>&quot;
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>查询结果：</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;is_partial&quot;</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">&quot;is_running&quot;</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">&quot;took&quot;</span> <span class="token operator">:</span> <span class="token number">397</span><span class="token punctuation">,</span>
  <span class="token property">&quot;timed_out&quot;</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">&quot;hits&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;total&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;value&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
      <span class="token property">&quot;relation&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;eq&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;sequences&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;join_keys&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token string">&quot;42FC7E13-CB3E-5C05-0000-0010A0125101&quot;</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token property">&quot;events&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span>
            <span class="token property">&quot;_index&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;gmall&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;6B14_IgBCaaR_R-J1qan&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;_source&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
              <span class="token property">&quot;@timestamp&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;2022-06-01T12:00:00.00+08:00&quot;</span><span class="token punctuation">,</span>
              <span class="token property">&quot;event&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;category&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;page&quot;</span>
              <span class="token punctuation">}</span><span class="token punctuation">,</span>
              <span class="token property">&quot;page&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;session_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;42FC7E13-CB3E-5C05-0000-0010A0125101&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;last_page_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;page_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;login&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;user_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;&quot;</span>
              <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span>
            <span class="token property">&quot;_index&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;gmall&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;6h14_IgBCaaR_R-J16ZD&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;_source&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
              <span class="token property">&quot;@timestamp&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;2022-06-01T12:05:00.00+08:00&quot;</span><span class="token punctuation">,</span>
              <span class="token property">&quot;event&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;category&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;page&quot;</span>
              <span class="token punctuation">}</span><span class="token punctuation">,</span>
              <span class="token property">&quot;page&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;session_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;42FC7E13-CB3E-5C05-0000-0010A0125101&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;last_page_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;good_list&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;page_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;good_detail&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;user_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;1&quot;</span>
              <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="安全检测" tabindex="-1"><a class="header-anchor" href="#安全检测" aria-hidden="true">#</a> 安全检测</h3><p>EQL 在 Elastic Securit 中被广泛使用。实际应用时，我们可以使用 EQL 语言来进行检测安全威胁和其他可疑行为。</p><h4 id="_1、数据准备" tabindex="-1"><a class="header-anchor" href="#_1、数据准备" aria-hidden="true">#</a> 1、数据准备</h4><p>regsvr32.exe 是一个内置的命令行实用程序，用于在 Windows 中注册.dll 库。作为本机工具，regsvr32.exe 具有受信任的状态，从而使它可以绕过大多数允许列表软件和脚本阻止程序。 有权访问用户命令行的攻击者可以使用 regsvr32.exe 通过.dll 库运行恶意脚本，即使在其他情况下也不允许这些脚本运行。</p><p>regsvr32 滥用的一种常见变体是 Squfullydoo 攻击。在 Squfullydoo 攻击中，regsvr32.exe 命令使用 scrobj.dll 库注册并运行远程脚本。</p><p>测试数据来自 Atomic Red Team 的测试数据集，其中包括模仿 Squibledoo 攻击的事件。数据已映射到 Elastic 通用架构（ECS）字段：normalized-T1117-AtomicRed-regsvr32.json将文件内容导入到 ES 软件中：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># 创建索引</span>
PUT my-eql-index
<span class="token comment"># 导入数据</span>
POST my-eql-index/_bulk?pretty<span class="token operator">&amp;</span>refresh
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>详细数据如下：</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;parent&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;powershell.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-C11D-5C05-0000-0010C6E90401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;cmd.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CB3E-5C05-0000-0010A0125101}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;command_line&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\\&quot;C:\\\\WINDOWS\\\\system32\\\\cmd.exe\\&quot; /c \\&quot;for /R c: %%f in (*.docx) do copy %%f c:\\\\temp\\\\\\&quot;&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\cmd.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;ppid&quot;</span><span class="token operator">:</span> <span class="token number">7036</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;logon_id&quot;</span><span class="token operator">:</span> <span class="token number">217055</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883571822010000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;process&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;creation&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;user&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;full_name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;bob&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;domain&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ART-DESKTOP&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ART-DESKTOP\\\\bob&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;cmd.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CB3E-5C05-0000-0010A0125101}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\cmd.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\cmd.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;cmd.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883571821990000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;cmd.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CB3E-5C05-0000-0010A0125101}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\cmd.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\ntdll.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ntdll.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883571821990000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;cmd.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CB3E-5C05-0000-0010A0125101}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\cmd.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\kernel32.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;kernel32.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883571821990000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;cmd.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CB3E-5C05-0000-0010A0125101}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\cmd.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\KernelBase.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;KernelBase.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883571821990000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;cmd.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CB3E-5C05-0000-0010A0125101}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\cmd.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\msvcrt.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;msvcrt.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883571821990000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;cmd.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CB3E-5C05-0000-0010A0125101}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\cmd.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883571822140000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;process&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;terminate&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;parent&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;cmd.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010AA385401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\cmd.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;command_line&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe  /s /u /i:https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1117/RegSvr32.sct scrobj.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;ppid&quot;</span><span class="token operator">:</span> <span class="token number">2652</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;logon_id&quot;</span><span class="token operator">:</span> <span class="token number">217055</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573237130000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;process&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;creation&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;user&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;full_name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;bob&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;domain&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ART-DESKTOP&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ART-DESKTOP\\\\bob&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573237140000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\ntdll.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ntdll.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573237140000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\kernel32.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;kernel32.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573237140000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\KernelBase.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;KernelBase.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573237140000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\apphelp.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;apphelp.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573237140000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\AcLayers.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;AcLayers.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573237140000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\msvcrt.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;msvcrt.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573237140000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\user32.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;user32.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573237140000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\win32u.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;win32u.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573237140000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\gdi32.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;gdi32.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573237140000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\gdi32full.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;gdi32full.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573237140000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\msvcp_win.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;msvcp_win.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573237140000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\ucrtbase.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ucrtbase.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573237140000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\shlwapi.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shlwapi.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573237140000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\combase.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;combase.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573237140000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\rpcrt4.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;rpcrt4.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573237140000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\bcryptprimitives.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;bcryptprimitives.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573237140000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\sfc.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;sfc.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573237140000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\winspool.drv&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;winspool.drv&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573237140000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\kernel.appcore.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;kernel.appcore.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573237140000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\propsys.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;propsys.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573237140000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\oleaut32.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;oleaut32.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573237140000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\SHCore.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;SHCore.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573237140000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\sechost.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;sechost.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573237300000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\IPHLPAPI.DLL&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;IPHLPAPI.DLL&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573237300000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\bcrypt.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;bcrypt.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573237300000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\sfc.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;sfc.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573237300000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\sfc_os.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;sfc_os.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573237300000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\imm32.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;imm32.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573237300000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\ole32.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ole32.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573237300000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\uxtheme.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;uxtheme.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573237300000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\scrobj.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;scrobj.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573237450016</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\advapi32.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;advapi32.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573237450016</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\urlmon.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;urlmon.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573237450016</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\windows.storage.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;windows.storage.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573237450016</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\profapi.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;profapi.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573237450016</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\powrprof.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;powrprof.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573237450016</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\iertutil.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;iertutil.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573237450016</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\fltLib.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;fltLib.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573237450016</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\cryptbase.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;cryptbase.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573237450016</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\dwmapi.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;dwmapi.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573237450016</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\sspicli.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;sspicli.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573237930000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\ws2_32.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ws2_32.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573237930000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\OnDemandConnRouteHelper.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;OnDemandConnRouteHelper.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573237930000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\winhttp.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;winhttp.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573237930000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;registry&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKU\\\\S-1-5-21-2047549730-3016700585-885829632-1000\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings\\\\ZoneMap&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ZoneMap&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKU\\\\S-1-5-21-2047549730-3016700585-885829632-1000\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\WINDOWS\\\\system32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573237930000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;registry&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;registry&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKU\\\\S-1-5-21-2047549730-3016700585-885829632-1000\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings\\\\ZoneMap\\\\ProxyBypass&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ProxyBypass&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKU\\\\S-1-5-21-2047549730-3016700585-885829632-1000\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings\\\\ZoneMap&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\WINDOWS\\\\system32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573237930000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;registry&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;registry&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKU\\\\S-1-5-21-2047549730-3016700585-885829632-1000\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings\\\\ZoneMap\\\\IntranetName&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;IntranetName&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKU\\\\S-1-5-21-2047549730-3016700585-885829632-1000\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings\\\\ZoneMap&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\WINDOWS\\\\system32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573237930000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;registry&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;registry&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKU\\\\S-1-5-21-2047549730-3016700585-885829632-1000\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings\\\\ZoneMap\\\\UNCAsIntranet&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;UNCAsIntranet&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKU\\\\S-1-5-21-2047549730-3016700585-885829632-1000\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings\\\\ZoneMap&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\WINDOWS\\\\system32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573237930000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;registry&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;registry&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKU\\\\S-1-5-21-2047549730-3016700585-885829632-1000\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings\\\\ZoneMap\\\\AutoDetect&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;AutoDetect&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKU\\\\S-1-5-21-2047549730-3016700585-885829632-1000\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings\\\\ZoneMap&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\WINDOWS\\\\system32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573237930000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;registry&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;registry&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKU\\\\S-1-5-21-2047549730-3016700585-885829632-1000\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings\\\\ZoneMap\\\\ProxyBypass&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ProxyBypass&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKU\\\\S-1-5-21-2047549730-3016700585-885829632-1000\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings\\\\ZoneMap&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\WINDOWS\\\\system32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573237930000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;registry&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;registry&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKU\\\\S-1-5-21-2047549730-3016700585-885829632-1000\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings\\\\ZoneMap\\\\IntranetName&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;IntranetName&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKU\\\\S-1-5-21-2047549730-3016700585-885829632-1000\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings\\\\ZoneMap&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\WINDOWS\\\\system32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573237930000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;registry&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;registry&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKU\\\\S-1-5-21-2047549730-3016700585-885829632-1000\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings\\\\ZoneMap\\\\UNCAsIntranet&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;UNCAsIntranet&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKU\\\\S-1-5-21-2047549730-3016700585-885829632-1000\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings\\\\ZoneMap&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\WINDOWS\\\\system32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573237930000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;registry&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;registry&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKU\\\\S-1-5-21-2047549730-3016700585-885829632-1000\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings\\\\ZoneMap\\\\AutoDetect&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;AutoDetect&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKU\\\\S-1-5-21-2047549730-3016700585-885829632-1000\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings\\\\ZoneMap&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\WINDOWS\\\\system32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573237930000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;registry&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\nsi.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;nsi.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573238080000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\mswsock.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;mswsock.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573238080000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\winnsi.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;winnsi.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573238080000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\crypt32.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;crypt32.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573238080000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\msasn1.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;msasn1.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573238230000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\dpapi.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;dpapi.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573238230000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\wintrust.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;wintrust.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573238230000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\cryptsp.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;cryptsp.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573238230000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\rsaenh.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;rsaenh.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573238230000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;registry&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKU\\\\S-1-5-21-2047549730-3016700585-885829632-1000\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\WinTrust\\\\Trust Providers\\\\Software Publishing&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Software Publishing&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKU\\\\S-1-5-21-2047549730-3016700585-885829632-1000\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\WinTrust\\\\Trust Providers&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\WINDOWS\\\\system32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573238230000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;registry&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;registry&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKLM\\\\SOFTWARE\\\\Microsoft\\\\SystemCertificates\\\\ROOT&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ROOT&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKLM\\\\SOFTWARE\\\\Microsoft\\\\SystemCertificates&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\WINDOWS\\\\system32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573238230000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;registry&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;registry&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKLM\\\\SOFTWARE\\\\Microsoft\\\\SystemCertificates\\\\ROOT&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ROOT&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKLM\\\\SOFTWARE\\\\Microsoft\\\\SystemCertificates&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\WINDOWS\\\\system32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573238230000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;registry&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;registry&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKLM\\\\SOFTWARE\\\\Microsoft\\\\SystemCertificates\\\\AuthRoot&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;AuthRoot&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKLM\\\\SOFTWARE\\\\Microsoft\\\\SystemCertificates&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\WINDOWS\\\\system32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573238230000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;registry&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;registry&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKLM\\\\SOFTWARE\\\\Microsoft\\\\EnterpriseCertificates\\\\Root&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Root&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKLM\\\\SOFTWARE\\\\Microsoft\\\\EnterpriseCertificates&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\WINDOWS\\\\system32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573238230000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;registry&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;registry&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKLM\\\\SOFTWARE\\\\Microsoft\\\\EnterpriseCertificates\\\\Root&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Root&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKLM\\\\SOFTWARE\\\\Microsoft\\\\EnterpriseCertificates&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\WINDOWS\\\\system32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573238230000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;registry&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;registry&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKLM\\\\SOFTWARE\\\\Microsoft\\\\SystemCertificates\\\\SmartCardRoot&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;SmartCardRoot&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKLM\\\\SOFTWARE\\\\Microsoft\\\\SystemCertificates&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\WINDOWS\\\\system32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573238230000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;registry&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;registry&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKLM\\\\SOFTWARE\\\\Microsoft\\\\SystemCertificates\\\\CA&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;CA&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKLM\\\\SOFTWARE\\\\Microsoft\\\\SystemCertificates&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\WINDOWS\\\\system32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573238230000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;registry&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;registry&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKLM\\\\SOFTWARE\\\\Microsoft\\\\SystemCertificates\\\\CA&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;CA&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKLM\\\\SOFTWARE\\\\Microsoft\\\\SystemCertificates&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\WINDOWS\\\\system32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573238230000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;registry&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;registry&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKLM\\\\SOFTWARE\\\\Microsoft\\\\EnterpriseCertificates\\\\CA&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;CA&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKLM\\\\SOFTWARE\\\\Microsoft\\\\EnterpriseCertificates&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\WINDOWS\\\\system32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573238230000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;registry&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;registry&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKLM\\\\SOFTWARE\\\\Microsoft\\\\EnterpriseCertificates\\\\CA&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;CA&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKLM\\\\SOFTWARE\\\\Microsoft\\\\EnterpriseCertificates&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\WINDOWS\\\\system32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573238230000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;registry&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;registry&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKLM\\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\SystemCertificates\\\\Root&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Root&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKLM\\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\SystemCertificates&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\WINDOWS\\\\system32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573238230000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;registry&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;registry&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKLM\\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\SystemCertificates\\\\CA&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;CA&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKLM\\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\SystemCertificates&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\WINDOWS\\\\system32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573238230000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;registry&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;registry&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKU\\\\S-1-5-21-2047549730-3016700585-885829632-1000\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings\\\\5.0\\\\Cache\\\\Content\\\\CachePrefix&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;CachePrefix&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKU\\\\S-1-5-21-2047549730-3016700585-885829632-1000\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings\\\\5.0\\\\Cache\\\\Content&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\WINDOWS\\\\system32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573238230000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;registry&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;registry&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKU\\\\S-1-5-21-2047549730-3016700585-885829632-1000\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings\\\\5.0\\\\Cache\\\\Cookies\\\\CachePrefix&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;CachePrefix&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKU\\\\S-1-5-21-2047549730-3016700585-885829632-1000\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings\\\\5.0\\\\Cache\\\\Cookies&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\WINDOWS\\\\system32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573238230000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;registry&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;registry&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKU\\\\S-1-5-21-2047549730-3016700585-885829632-1000\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings\\\\5.0\\\\Cache\\\\History\\\\CachePrefix&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;CachePrefix&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKU\\\\S-1-5-21-2047549730-3016700585-885829632-1000\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings\\\\5.0\\\\Cache\\\\History&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\WINDOWS\\\\system32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573238230000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;registry&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\dnsapi.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;dnsapi.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573238230000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;registry&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKLM\\\\System\\\\CurrentControlSet\\\\Services\\\\Tcpip\\\\Parameters&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Parameters&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKLM\\\\System\\\\CurrentControlSet\\\\Services\\\\Tcpip&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\WINDOWS\\\\system32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573238230000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;registry&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;registry&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKLM\\\\System\\\\CurrentControlSet\\\\Services\\\\Tcpip\\\\Parameters&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Parameters&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKLM\\\\System\\\\CurrentControlSet\\\\Services\\\\Tcpip&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\WINDOWS\\\\system32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573238230000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;registry&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;registry&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKLM\\\\System\\\\CurrentControlSet\\\\Services\\\\Tcpip\\\\Parameters&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Parameters&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKLM\\\\System\\\\CurrentControlSet\\\\Services\\\\Tcpip&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\WINDOWS\\\\system32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573238230000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;registry&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\rasadhlp.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;rasadhlp.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573238230000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;registry&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKLM\\\\System\\\\CurrentControlSet\\\\Services\\\\Tcpip\\\\Parameters&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Parameters&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKLM\\\\System\\\\CurrentControlSet\\\\Services\\\\Tcpip&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\WINDOWS\\\\system32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573238230000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;registry&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;registry&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKLM\\\\System\\\\CurrentControlSet\\\\Services\\\\Tcpip\\\\Parameters&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Parameters&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKLM\\\\System\\\\CurrentControlSet\\\\Services\\\\Tcpip&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\WINDOWS\\\\system32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573238230000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;registry&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;registry&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKLM\\\\System\\\\CurrentControlSet\\\\Services\\\\Tcpip\\\\Parameters&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Parameters&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKLM\\\\System\\\\CurrentControlSet\\\\Services\\\\Tcpip&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\WINDOWS\\\\system32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573238230000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;registry&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;registry&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKLM\\\\System\\\\CurrentControlSet\\\\Services\\\\Tcpip\\\\Parameters&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Parameters&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKLM\\\\System\\\\CurrentControlSet\\\\Services\\\\Tcpip&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\WINDOWS\\\\system32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573238230000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;registry&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\wininet.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;wininet.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573237930000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\FWPUCLNT.DLL&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;FWPUCLNT.DLL&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573238400000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\schannel.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;schannel.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573238700016</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;registry&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKLM\\\\System\\\\CurrentControlSet\\\\Control\\\\SecurityProviders\\\\SCHANNEL&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;SCHANNEL&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKLM\\\\System\\\\CurrentControlSet\\\\Control\\\\SecurityProviders&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\WINDOWS\\\\system32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573238700016</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;registry&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\mskeyprotect.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;mskeyprotect.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573238869984</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\ncrypt.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ncrypt.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573238869984</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\ntasn1.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ntasn1.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573238869984</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;registry&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKU\\\\S-1-5-21-2047549730-3016700585-885829632-1000\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\WinTrust\\\\Trust Providers\\\\Software Publishing&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Software Publishing&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKU\\\\S-1-5-21-2047549730-3016700585-885829632-1000\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\WinTrust\\\\Trust Providers&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\WINDOWS\\\\system32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573238869984</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;registry&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\cryptnet.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;cryptnet.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573238869984</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;registry&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKU\\\\S-1-5-21-2047549730-3016700585-885829632-1000_Classes\\\\Local Settings\\\\MuiCache\\\\1\\\\52C64B7E\\\\LanguageList&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;LanguageList&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKU\\\\S-1-5-21-2047549730-3016700585-885829632-1000_Classes\\\\Local Settings\\\\MuiCache\\\\1\\\\52C64B7E&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\WINDOWS\\\\system32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573238869984</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;registry&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;registry&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKU\\\\S-1-5-21-2047549730-3016700585-885829632-1000_Classes\\\\Local Settings\\\\MuiCache\\\\1\\\\52C64B7E\\\\LanguageList&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;LanguageList&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKU\\\\S-1-5-21-2047549730-3016700585-885829632-1000_Classes\\\\Local Settings\\\\MuiCache\\\\1\\\\52C64B7E&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\WINDOWS\\\\system32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573238869984</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;registry&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;registry&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKU\\\\S-1-5-21-2047549730-3016700585-885829632-1000_Classes\\\\Local Settings\\\\MuiCache\\\\1\\\\52C64B7E\\\\LanguageList&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;LanguageList&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKU\\\\S-1-5-21-2047549730-3016700585-885829632-1000_Classes\\\\Local Settings\\\\MuiCache\\\\1\\\\52C64B7E&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\WINDOWS\\\\system32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573238869984</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;registry&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;registry&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKU\\\\S-1-5-21-2047549730-3016700585-885829632-1000_Classes\\\\Local Settings\\\\MuiCache\\\\1\\\\52C64B7E\\\\LanguageList&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;LanguageList&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKU\\\\S-1-5-21-2047549730-3016700585-885829632-1000_Classes\\\\Local Settings\\\\MuiCache\\\\1\\\\52C64B7E&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\WINDOWS\\\\system32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573238869984</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;registry&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;registry&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKU\\\\S-1-5-21-2047549730-3016700585-885829632-1000_Classes\\\\Local Settings\\\\MuiCache\\\\1\\\\52C64B7E\\\\LanguageList&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;LanguageList&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKU\\\\S-1-5-21-2047549730-3016700585-885829632-1000_Classes\\\\Local Settings\\\\MuiCache\\\\1\\\\52C64B7E&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\WINDOWS\\\\system32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573238869984</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;registry&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;registry&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKU\\\\S-1-5-21-2047549730-3016700585-885829632-1000_Classes\\\\Local Settings\\\\MuiCache\\\\1\\\\52C64B7E\\\\LanguageList&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;LanguageList&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKU\\\\S-1-5-21-2047549730-3016700585-885829632-1000_Classes\\\\Local Settings\\\\MuiCache\\\\1\\\\52C64B7E&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\WINDOWS\\\\system32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573238869984</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;registry&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;registry&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKU\\\\S-1-5-21-2047549730-3016700585-885829632-1000_Classes\\\\Local Settings\\\\MuiCache\\\\1\\\\52C64B7E\\\\LanguageList&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;LanguageList&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKU\\\\S-1-5-21-2047549730-3016700585-885829632-1000_Classes\\\\Local Settings\\\\MuiCache\\\\1\\\\52C64B7E&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\WINDOWS\\\\system32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573238869984</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;registry&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;registry&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKU\\\\S-1-5-21-2047549730-3016700585-885829632-1000_Classes\\\\Local Settings\\\\MuiCache\\\\1\\\\52C64B7E\\\\LanguageList&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;LanguageList&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKU\\\\S-1-5-21-2047549730-3016700585-885829632-1000_Classes\\\\Local Settings\\\\MuiCache\\\\1\\\\52C64B7E&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\WINDOWS\\\\system32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573238869984</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;registry&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;registry&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKU\\\\S-1-5-21-2047549730-3016700585-885829632-1000_Classes\\\\Local Settings\\\\MuiCache\\\\1\\\\52C64B7E\\\\LanguageList&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;LanguageList&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKU\\\\S-1-5-21-2047549730-3016700585-885829632-1000_Classes\\\\Local Settings\\\\MuiCache\\\\1\\\\52C64B7E&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\WINDOWS\\\\system32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573238869984</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;registry&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;registry&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKU\\\\S-1-5-21-2047549730-3016700585-885829632-1000_Classes\\\\Local Settings\\\\MuiCache\\\\1\\\\52C64B7E\\\\LanguageList&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;LanguageList&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKU\\\\S-1-5-21-2047549730-3016700585-885829632-1000_Classes\\\\Local Settings\\\\MuiCache\\\\1\\\\52C64B7E&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\WINDOWS\\\\system32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573238869984</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;registry&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;registry&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKU\\\\S-1-5-21-2047549730-3016700585-885829632-1000_Classes\\\\Local Settings\\\\MuiCache\\\\1\\\\52C64B7E\\\\LanguageList&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;LanguageList&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKU\\\\S-1-5-21-2047549730-3016700585-885829632-1000_Classes\\\\Local Settings\\\\MuiCache\\\\1\\\\52C64B7E&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\WINDOWS\\\\system32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573238869984</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;registry&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;registry&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKU\\\\S-1-5-21-2047549730-3016700585-885829632-1000_Classes\\\\Local Settings\\\\MuiCache\\\\1\\\\52C64B7E\\\\LanguageList&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;LanguageList&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKU\\\\S-1-5-21-2047549730-3016700585-885829632-1000_Classes\\\\Local Settings\\\\MuiCache\\\\1\\\\52C64B7E&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\WINDOWS\\\\system32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573238869984</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;registry&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;registry&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKU\\\\S-1-5-21-2047549730-3016700585-885829632-1000_Classes\\\\Local Settings\\\\MuiCache\\\\1\\\\52C64B7E\\\\LanguageList&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;LanguageList&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKU\\\\S-1-5-21-2047549730-3016700585-885829632-1000_Classes\\\\Local Settings\\\\MuiCache\\\\1\\\\52C64B7E&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\WINDOWS\\\\system32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573238869984</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;registry&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;registry&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKU\\\\S-1-5-21-2047549730-3016700585-885829632-1000_Classes\\\\Local Settings\\\\MuiCache\\\\1\\\\52C64B7E\\\\LanguageList&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;LanguageList&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKU\\\\S-1-5-21-2047549730-3016700585-885829632-1000_Classes\\\\Local Settings\\\\MuiCache\\\\1\\\\52C64B7E&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\WINDOWS\\\\system32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573238869984</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;registry&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;registry&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKU\\\\S-1-5-21-2047549730-3016700585-885829632-1000_Classes\\\\Local Settings\\\\MuiCache\\\\1\\\\52C64B7E\\\\LanguageList&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;LanguageList&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKU\\\\S-1-5-21-2047549730-3016700585-885829632-1000_Classes\\\\Local Settings\\\\MuiCache\\\\1\\\\52C64B7E&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\WINDOWS\\\\system32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573238869984</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;registry&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;registry&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKU\\\\S-1-5-21-2047549730-3016700585-885829632-1000_Classes\\\\Local Settings\\\\MuiCache\\\\1\\\\52C64B7E\\\\LanguageList&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;LanguageList&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKU\\\\S-1-5-21-2047549730-3016700585-885829632-1000_Classes\\\\Local Settings\\\\MuiCache\\\\1\\\\52C64B7E&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\WINDOWS\\\\system32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573238869984</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;registry&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\ncryptsslp.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ncryptsslp.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573239170000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\clbcatq.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;clbcatq.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573240110000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\wldp.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;wldp.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573240110000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;registry&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKU\\\\S-1-5-21-2047549730-3016700585-885829632-1000\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\WinTrust\\\\Trust Providers\\\\Software Publishing&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Software Publishing&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKU\\\\S-1-5-21-2047549730-3016700585-885829632-1000\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\WinTrust\\\\Trust Providers&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\WINDOWS\\\\system32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573240110000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;registry&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\userenv.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;userenv.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573240270000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\version.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;version.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573240430000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\shell32.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shell32.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573240430000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\cfgmgr32.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;cfgmgr32.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573240430000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\mpr.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;mpr.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573240430000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\sxs.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;sxs.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573240580000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\gpapi.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;gpapi.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573240580000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\OneCoreUAPCommonProxyStub.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;OneCoreUAPCommonProxyStub.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573240740000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;registry&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKLM\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\\\\Desktop\\\\NameSpace&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;NameSpace&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKLM\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\\\\Desktop&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\WINDOWS\\\\system32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573240740000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;registry&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;registry&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKU\\\\S-1-5-21-2047549730-3016700585-885829632-1000\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\\\\Desktop\\\\NameSpace&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;NameSpace&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKU\\\\S-1-5-21-2047549730-3016700585-885829632-1000\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\\\\Desktop&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\WINDOWS\\\\system32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573240740000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;registry&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;registry&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKLM\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\\\\Desktop\\\\NameSpace\\\\DelegateFolders&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;DelegateFolders&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKLM\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\\\\Desktop\\\\NameSpace&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\WINDOWS\\\\system32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573240740000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;registry&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\jscript.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;jscript.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573240270000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\amsi.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;amsi.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573240270000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;registry&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKLM\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\\\\SyncRootManager&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;SyncRootManager&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKLM\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\WINDOWS\\\\system32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573240890000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;registry&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\edputil.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;edputil.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573240890000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\Windows.StateRepositoryPS.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Windows.StateRepositoryPS.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573240890000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\ProgramData\\\\Microsoft\\\\Windows Defender\\\\Platform\\\\4.18.1810.5-0\\\\MpOAV.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;MpOAV.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573240430000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\cldapi.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;cldapi.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573241050000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\WinTypes.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;WinTypes.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573241050000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\wshom.ocx&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;wshom.ocx&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573240430000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;registry&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKLM\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Notifications\\\\Data\\\\418A073AA3BC3475&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;418A073AA3BC3475&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HKLM\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Notifications\\\\Data&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\WINDOWS\\\\system32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573241200016</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;registry&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\scrrun.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;scrrun.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573240430000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\ProgramData\\\\Microsoft\\\\Windows Defender\\\\Platform\\\\4.18.1810.5-0\\\\MpClient.dll&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;MpClient.dll&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573240580000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;library&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573241369984</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;process&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;termination&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">&quot;process&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token property">&quot;entity_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{42FC7E13-CBCB-5C05-0000-0010A0395401}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;executable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:\\\\Windows\\\\System32\\\\regsvr32.exe&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;destination&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;address&quot;</span><span class="token operator">:</span> <span class="token string">&quot;151.101.48.133&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;port&quot;</span><span class="token operator">:</span> <span class="token string">&quot;443&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;address&quot;</span><span class="token operator">:</span> <span class="token string">&quot;192.168.162.134&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;port&quot;</span><span class="token operator">:</span> <span class="token string">&quot;50505&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;network&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;direction&quot;</span><span class="token operator">:</span> <span class="token string">&quot;outbound&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;protocol&quot;</span><span class="token operator">:</span> <span class="token string">&quot;tcp&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;@timestamp&quot;</span><span class="token operator">:</span> <span class="token number">131883573238680000</span><span class="token punctuation">,</span> <span class="token property">&quot;event&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;category&quot;</span><span class="token operator">:</span> <span class="token string">&quot;network&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;user&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;full_name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;bob&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;domain&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ART-DESKTOP&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ART-DESKTOP\\\\bob&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># 导入数据</span>
GET /_cat/indices/my-eql-index?v<span class="token operator">=</span>true<span class="token operator">&amp;</span><span class="token assign-left variable">h</span><span class="token operator">=</span>health,status,index,docs.count
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2、获取-regsvr32-事件的计数" tabindex="-1"><a class="header-anchor" href="#_2、获取-regsvr32-事件的计数" aria-hidden="true">#</a> <strong>2、获取 regsvr32 事件的计数</strong></h4><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># 查询数据</span>
<span class="token comment"># ?filter_path=-hits.events 从响应中排除 hits.events 属性。 此搜索仅用于获取事件计数，</span>
而不是匹配事件的列表
<span class="token comment"># query : 匹配任何进程名称为 regsvr32.exe 的事件</span>
<span class="token comment"># size : 最多返回 200 个匹配事件的匹配,实际查询结果为 143 个</span>
GET my-eql-index/_eql/search?filter_path<span class="token operator">=</span>-hits.events
<span class="token punctuation">{</span>
 <span class="token string">&quot;query&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>&quot;
 any where process.name <span class="token operator">==</span> <span class="token string">&quot;regsvr32.exe&quot;</span> 
 <span class="token string">&quot;&quot;</span>&quot;,
 <span class="token string">&quot;size&quot;</span><span class="token builtin class-name">:</span> <span class="token number">200</span> 
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3、检查命令行参数" tabindex="-1"><a class="header-anchor" href="#_3、检查命令行参数" aria-hidden="true">#</a> 3、检查命令行参数</h4><p>regsvr32.exe 进程与 143 个事件相关联。 但是如何首先调用 regsvr32.exe？谁调用的？</p><p>regsvr32.exe 是一个命令行实用程序。将结果缩小到使用命令行的进程</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># 增加过滤条件查询数据</span>
GET my-eql-index/_eql/search
<span class="token punctuation">{</span>
 <span class="token string">&quot;query&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>&quot;
 process where process.name <span class="token operator">==</span> <span class="token string">&quot;regsvr32.exe&quot;</span> and 
process.command_line.keyword <span class="token operator">!=</span> null 
 <span class="token string">&quot;&quot;</span>&quot;
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>该查询将一个事件与创建的 event.type 相匹配，指示 regsvr32.exe 进程的开始。根据事件的 process.command_line 值，regsvr32.exe 使用 scrobj.dll 注册了脚本 RegSvr32.sct.这符合 Squibledoo 攻击的行为</p><h4 id="_4、检查恶意脚本加载" tabindex="-1"><a class="header-anchor" href="#_4、检查恶意脚本加载" aria-hidden="true">#</a> 4、检查恶意脚本加载</h4><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># 增加过滤条件查询数据</span>
GET my-eql-index/_eql/search
<span class="token punctuation">{</span>
 <span class="token string">&quot;query&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>&quot;
 library where process.name <span class="token operator">==</span> <span class="token string">&quot;regsvr32.exe&quot;</span> and dll.name <span class="token operator">==</span> <span class="token string">&quot;scrobj.dll&quot;</span> 
 <span class="token string">&quot;&quot;</span>&quot; 
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_5、检查攻击成功可能性" tabindex="-1"><a class="header-anchor" href="#_5、检查攻击成功可能性" aria-hidden="true">#</a> 5、检查攻击成功可能性</h4><p>在许多情况下，攻击者使用恶意脚本连接到远程服务器或下载其他文件</p><p>使用 EQL 序列查询来检查以下一系列事件：</p><p>（1）regsvr32.exe 进程</p><p>（2）通过相同的进程加载 scrobj.dll 库</p><p>（3） 同一过程中的任何网络事件</p><p>根据上一个响应中看到的命令行值，你可以期望找到一个匹配项。但是，此查询并非针对该特定命令而设计。取而代之的是，它寻找一种可疑行为的模式，这种模式足以检测出相似的威胁</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># 增加过滤条件查询数据</span>
GET my-eql-index/_eql/search
<span class="token punctuation">{</span>
 <span class="token string">&quot;query&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>&quot;
 sequence by process.pid
 <span class="token punctuation">[</span>process where process.name <span class="token operator">==</span> <span class="token string">&quot;regsvr32.exe&quot;</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span>library where dll.name <span class="token operator">==</span> <span class="token string">&quot;scrobj.dll&quot;</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span>network where true<span class="token punctuation">]</span> 
 <span class="token string">&quot;&quot;</span>&quot; 
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="三、sql操作" tabindex="-1"><a class="header-anchor" href="#三、sql操作" aria-hidden="true">#</a> 三、SQL操作</h2><p><img src="`+i+`" alt="image-20230627192918942"></p><p>一般使用 Elasticsearch 的时候，会使用 Query DSL 来查询数据，从 Elasticsearch6.3 版本以后，Elasticsearch 已经支持 SQL 查询了。</p><p>Elasticsearch SQL 是一个 X-Pack 组件，它允许针对 Elasticsearch 实时执行类似 SQL 的查询。无论使用 REST 接口，命令行还是 JDBC，任何客户端都可以使用 SQL 对 Elasticsearch中的数据进行原生搜索和聚合数据。可以将 Elasticsearch SQL 看作是一种翻译器，它可以将SQL 翻译成 Query DSL。</p><p>Elasticsearch SQL 具有如下特性：</p><p>➢ 原生支持：Elasticsearch SQL 是专门为 Elasticsearch 打造的。</p><p>➢ 没有额外的零件：无需其他硬件，处理器，运行环境或依赖库即可查询 Elasticsearch，Elasticsearch SQL 直接在 Elasticsearch 内部运行。</p><p>➢ 轻巧高效：Elasticsearch SQL 并未抽象化其搜索功能，相反的它拥抱并接受了 SQL 来实现全文搜索，以简洁的方式实时运行全文搜索。</p><h3 id="sql-和-elasticsearch-的对应关系" tabindex="-1"><a class="header-anchor" href="#sql-和-elasticsearch-的对应关系" aria-hidden="true">#</a> <strong>SQL</strong> <strong>和</strong> <strong>Elasticsearch</strong> <strong>的对应关系</strong></h3><p>虽然 SQL 和 Elasticsearch 对数据的组织方式（以及不同的语义）有不同的术语，但它们的目的本质上是相同的。</p><table><thead><tr><th>SQL</th><th><strong>Elasticsearch</strong></th><th>描述</th></tr></thead><tbody><tr><td>Column</td><td>field</td><td>对比两个，数据都存储在命名条目中，具有多种数据类型，包含一个值。SQL 将此类条目称为列，而 Elasticsearch 称为字段。请注意，在 Elasticsearch 中，一个字段可以包含多个相同类型的值（本质上是一个列表），而在 SQL 中，一个列可以只包含一个所述类型的值。Elasticsearch SQL 将尽最大努力保留 SQL 语义，并根据查询拒绝那些返回具有多个值的字段的查询</td></tr><tr><td>Row</td><td>Document</td><td>Columns 和 fields 本身不存在；它们是 row 或 a 的一部分 document。两者的语义略有不同：row 趋于严格（并且有更多的强制执行），而document 趋于更加灵活或松散（同时仍然具有结构）版权声明：本文为CSDN博主「MinggeQingchun」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。</td></tr><tr><td>Table</td><td>Index</td><td>执行查询的目标</td></tr><tr><td>Schema</td><td>Mapping</td><td>在 RDBMS 中，schem 主要是表的命名空间，通常用作安全边界。Elasticsearch 没有为它提供等效的概念。但是，当启用安全性时，Elasticsearch 会自动应用安全性强制，以便角色只能看到它被允许访</td></tr><tr><td>Database</td><td>Cluster实例</td><td>在 SQL 中，catalog 或者 database 从概念上可以互换使用，表示一组模式，即多个表。在 Elasticsearch 中，可用的索引集被分组在一个cluster，语义也有所不同。database 本质上是另一个命名空间（可能对数据的存储方式有一些影响），而 Elasticsearch cluster 是一个运行时实例，或者更确切地说是一组至少一个 Elasticsearch 实例（通常是分布式运行）。在实践中，这意味着虽然在 SQL 中，一个实例中可能有多个目录，但在 Elasticsearch 中，一个目录仅限于一个版权声明：本文为CSDN博主「MinggeQingchun」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。</td></tr></tbody></table><p>虽然概念之间的映射并不完全是一对一的，语义也有所不同，但共同点多于差异。事实上，SQL 的许多概念可以在 Elasticsearch 中找到对应关系，并且这两者的术语也很类似</p><h3 id="数据准备-1" tabindex="-1"><a class="header-anchor" href="#数据准备-1" aria-hidden="true">#</a> 数据准备</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># 创建索引并增加数据，等同于创建表和数据</span>
PUT my-sql-index/_bulk?refresh
<span class="token punctuation">{</span><span class="token string">&quot;index&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;_id&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;JAVA&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;JAVA&quot;</span>, <span class="token string">&quot;author&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;zhangsan&quot;</span>, <span class="token string">&quot;release_date&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;2022-05-01&quot;</span>, 
<span class="token string">&quot;page_count&quot;</span><span class="token builtin class-name">:</span> <span class="token number">561</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">&quot;index&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;_id&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;BIGDATA&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;BIGDATA&quot;</span>, <span class="token string">&quot;author&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;lisi&quot;</span>, <span class="token string">&quot;release_date&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;2022-05-02&quot;</span>, <span class="token string">&quot;page_count&quot;</span><span class="token builtin class-name">:</span> 
<span class="token number">482</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">&quot;index&quot;</span>:<span class="token punctuation">{</span><span class="token string">&quot;_id&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;SCALA&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;SCALA&quot;</span>, <span class="token string">&quot;author&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;wangwu&quot;</span>, <span class="token string">&quot;release_date&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;2022-05-03&quot;</span>, <span class="token string">&quot;page_count&quot;</span><span class="token builtin class-name">:</span> 
<span class="token number">604</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="`+k+`" alt="image-20230627193455859"></p><h3 id="第一个sql查询" tabindex="-1"><a class="header-anchor" href="#第一个sql查询" aria-hidden="true">#</a> 第一个SQL查询</h3><p>现在可以使用 SQL 对数据进行查询了。</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># SQL</span>
<span class="token comment"># 这里的表就是索引</span>
<span class="token comment"># 可以通过 format 参数控制返回结果的格式，默认为 json 格式</span>
<span class="token comment"># txt:表示文本格式，看起来更直观点.</span>
<span class="token comment"># csv:使用逗号隔开的数据</span>
<span class="token comment"># json:JSON 格式数据</span>
<span class="token comment"># tsv: 使用 tab 键隔开数据</span>
<span class="token comment"># yaml:属性配置格式</span>
POST _sql?format<span class="token operator">=</span>txt
<span class="token punctuation">{</span>
 <span class="token string">&quot;query&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>&quot;
 SELECT * FROM <span class="token string">&quot;my-sql-index&quot;</span>
 <span class="token string">&quot;&quot;</span>&quot;
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="`+q+`" alt="image-20230627193610072"></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># 条件查询</span>
POST _sql?format<span class="token operator">=</span>txt
<span class="token punctuation">{</span>
 <span class="token string">&quot;query&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>&quot;
 SELECT * FROM <span class="token string">&quot;my-sql-index&quot;</span> where page_count <span class="token operator">&gt;</span> <span class="token number">500</span>
 <span class="token string">&quot;&quot;</span>&quot;
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="`+d+`" alt="image-20230627193648879"></p><p>实际上会发现，和 JDBC 操作时的 SQL 语法是基本是一样的。</p><h3 id="sql转换为dsl使用" tabindex="-1"><a class="header-anchor" href="#sql转换为dsl使用" aria-hidden="true">#</a> SQL转换为DSL使用</h3><p>当我们需要使用 Query DSL 时，也可以先使用 SQL 来查询，然后通过 Translate API 转换即可，查询的结果为 DSL 方式的结果</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># 转换 SQL 为 DSL 进行操作</span>
POST _sql/translate
<span class="token punctuation">{</span>
 <span class="token string">&quot;query&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>&quot;
 SELECT * FROM <span class="token string">&quot;my-sql-index&quot;</span> where page_count <span class="token operator">&gt;</span> <span class="token number">500</span>
 <span class="token string">&quot;&quot;</span>&quot;
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="`+m+`" alt="image-20230627193912335"></p><h3 id="sql-和-dsl-混合使用" tabindex="-1"><a class="header-anchor" href="#sql-和-dsl-混合使用" aria-hidden="true">#</a> <strong>SQL</strong> <strong>和</strong> <strong>DSL</strong> <strong>混合使用</strong></h3><p>我们如果在优化 SQL 语句之后还不满足查询需求，可以拿 SQL 和 DSL 混用，ES 会先根据SQL 进行查询，然后根据 DSL 语句对 SQL 的执行结果进行二次查询</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># SQL 和 DSL 混合使用</span>
<span class="token comment"># 由于索引中含有横线，所以作为表名时需要采用双引号，且外层需要三个引号包含</span>
POST _sql?format<span class="token operator">=</span>txt
<span class="token punctuation">{</span>
  <span class="token string">&quot;query&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>&quot;SELECT * FROM <span class="token string">&quot;my-sql-index&quot;</span> <span class="token string">&quot;&quot;</span>&quot;,
  <span class="token string">&quot;filter&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;range&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
      <span class="token string">&quot;page_count&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;gte&quot;</span><span class="token builtin class-name">:</span> <span class="token number">400</span>,
        <span class="token string">&quot;lte&quot;</span><span class="token builtin class-name">:</span> <span class="token number">600</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>,
  <span class="token string">&quot;fetch_size&quot;</span><span class="token builtin class-name">:</span> <span class="token number">2</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="`+v+`" alt="image-20230627193947105"></p><h3 id="常用sql操作" tabindex="-1"><a class="header-anchor" href="#常用sql操作" aria-hidden="true">#</a> 常用SQL操作</h3><h4 id="查询所有索引" tabindex="-1"><a class="header-anchor" href="#查询所有索引" aria-hidden="true">#</a> 查询所有索引</h4><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>GET _sql?format<span class="token operator">=</span>txt
<span class="token punctuation">{</span>
 <span class="token string">&quot;query&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>&quot;
 show tables
 <span class="token string">&quot;&quot;</span>&quot;
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="`+y+`" alt="image-20230627194153202"></p><h4 id="查询指定索引" tabindex="-1"><a class="header-anchor" href="#查询指定索引" aria-hidden="true">#</a> 查询指定索引</h4><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>GET _sql?format<span class="token operator">=</span>txt
<span class="token punctuation">{</span>
 <span class="token string">&quot;query&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>&quot;
 show tables like <span class="token string">&#39;myindex&#39;</span>
 <span class="token string">&quot;&quot;</span>&quot;
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="`+g+`" alt="image-20230627194211918"></p><h4 id="模糊查询索引" tabindex="-1"><a class="header-anchor" href="#模糊查询索引" aria-hidden="true">#</a> 模糊查询索引</h4><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>GET _sql?format<span class="token operator">=</span>txt
<span class="token punctuation">{</span>
 <span class="token string">&quot;query&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>&quot;
 show tables like <span class="token string">&#39;my-%&#39;</span>
 <span class="token string">&quot;&quot;</span>&quot;
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="`+b+`" alt="image-20230627194230793"></p><h4 id="查看索引结构" tabindex="-1"><a class="header-anchor" href="#查看索引结构" aria-hidden="true">#</a> 查看索引结构</h4><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>GET _sql?format<span class="token operator">=</span>txt
<span class="token punctuation">{</span>
 <span class="token string">&quot;query&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>&quot;
 describe myindex
 <span class="token string">&quot;&quot;</span>&quot;
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="`+C+`" alt="image-20230627194253711"></p><h4 id="基础查询操作" tabindex="-1"><a class="header-anchor" href="#基础查询操作" aria-hidden="true">#</a> 基础查询操作</h4><p>在 ES 中使用 SQL 查询的语法与在数据库中使用基本一致，具体格式如下:</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># 基本 SQL 格式</span>
SELECT select_expr <span class="token punctuation">[</span>, <span class="token punctuation">..</span>.<span class="token punctuation">]</span>
<span class="token punctuation">[</span> FROM table_name <span class="token punctuation">]</span>
<span class="token punctuation">[</span> WHERE condition <span class="token punctuation">]</span>
<span class="token punctuation">[</span> GROUP BY grouping_element <span class="token punctuation">[</span>, <span class="token punctuation">..</span>.<span class="token punctuation">]</span> <span class="token punctuation">]</span>
<span class="token punctuation">[</span> HAVING condition<span class="token punctuation">]</span>
<span class="token punctuation">[</span> ORDER BY expression <span class="token punctuation">[</span> ASC <span class="token operator">|</span> DESC <span class="token punctuation">]</span> <span class="token punctuation">[</span>, <span class="token punctuation">..</span>.<span class="token punctuation">]</span> <span class="token punctuation">]</span>
<span class="token punctuation">[</span> LIMIT <span class="token punctuation">[</span> count <span class="token punctuation">]</span> <span class="token punctuation">]</span>
<span class="token punctuation">[</span> PIVOT <span class="token punctuation">(</span> aggregation_expr FOR <span class="token function">column</span> IN <span class="token punctuation">(</span> value <span class="token punctuation">[</span> <span class="token punctuation">[</span> AS <span class="token punctuation">]</span> <span class="token builtin class-name">alias</span> <span class="token punctuation">]</span> <span class="token punctuation">[</span>, <span class="token punctuation">..</span>.<span class="token punctuation">]</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>where</li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># 条件过滤</span>
POST _sql?format<span class="token operator">=</span>txt
<span class="token punctuation">{</span>
 <span class="token string">&quot;query&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>&quot; SELECT * FROM <span class="token string">&quot;my-sql-index&quot;</span> where name <span class="token operator">=</span> <span class="token string">&#39;JAVA&#39;</span> <span class="token string">&quot;&quot;</span>&quot;
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="`+h+`" alt="image-20230627194345909"></p><ul><li>group by</li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># 查询所有数据</span>
GET _sql?format<span class="token operator">=</span>txt
<span class="token punctuation">{</span>
 <span class="token string">&quot;query&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>&quot;
 SELECT * FROM <span class="token string">&quot;my-sql-index&quot;</span> 
 <span class="token string">&quot;&quot;</span>&quot;
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="`+x+`" alt="image-20230627194416740"></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># 按照日期进行分组</span>
GET _sql?format<span class="token operator">=</span>txt
<span class="token punctuation">{</span>
 <span class="token string">&quot;query&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>&quot;
 SELECT release_date FROM <span class="token string">&quot;my-sql-index&quot;</span> group by release_date
 <span class="token string">&quot;&quot;</span>&quot;
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="`+S+`" alt="image-20230627194442947"></p><ul><li>having</li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># 对分组后的数据进行过滤</span>
GET _sql?format<span class="token operator">=</span>txt
<span class="token punctuation">{</span>
 <span class="token string">&quot;query&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>&quot;
 SELECT sum<span class="token punctuation">(</span>page_count<span class="token punctuation">)</span>, release_date as datacnt FROM <span class="token string">&quot;my-sql-index&quot;</span> group 
by release_date having sum<span class="token punctuation">(</span>page_count<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">1000</span>
 <span class="token string">&quot;&quot;</span>&quot;
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="`+E+`" alt="image-20230627194510964"></p><ul><li>order by</li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># 对页面数量进行排序（降序）</span>
GET _sql?format<span class="token operator">=</span>txt
<span class="token punctuation">{</span>
 <span class="token string">&quot;query&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>&quot;
 <span class="token keyword">select</span> * from <span class="token string">&quot;my-sql-index&quot;</span> order by page_count desc
 <span class="token string">&quot;&quot;</span>&quot;
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="`+w+`" alt="image-20230627194552148"></p><ul><li>limit</li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># 限定查询数量</span>
GET _sql?format<span class="token operator">=</span>txt
<span class="token punctuation">{</span>
 <span class="token string">&quot;query&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>&quot;
 <span class="token keyword">select</span> * from <span class="token string">&quot;my-sql-index&quot;</span> limit <span class="token number">3</span>
 <span class="token string">&quot;&quot;</span>&quot;
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="`+_+`" alt="image-20230627194622031"></p><ul><li>cursor</li></ul><p>游标（cursor）是系统为用户开设的一个数据缓冲区，存储 sql 语句的执行结果，每个游标区都有一个名字，用户可以用 sql 语句逐一从游标中获取记录，并赋给主变量，交由主语言进一步处理。就本质而言，游标实际上是一种能从包括多条数据记录的结果集中每次提取一条或多条记录的机制</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># 查询数据</span>
<span class="token comment"># 因为查询结果较多，但是获取的数据较少，所以为了提高效果，会将数据存储到临时缓冲区中</span>
<span class="token comment"># 此处数据展示格式为 json</span>
POST _sql?format<span class="token operator">=</span>json
<span class="token punctuation">{</span>
 <span class="token string">&quot;query&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>&quot; SELECT * FROM <span class="token string">&quot;my-sql-index&quot;</span> order by page_count desc <span class="token string">&quot;&quot;</span>&quot;,
 <span class="token string">&quot;fetch_size&quot;</span><span class="token builtin class-name">:</span> <span class="token number">2</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="`+f+`" alt="image-20230627194708190"></p><p>返回结果中的 cursor 就是缓冲区的标识，这就意味着可以从缓冲区中直接获取后续数据，操作上有点类似于迭代器，可多次执行。</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># 此处游标 cursor 值需要根据读者执行的操作进行修改，请勿直接使用</span>
POST /_sql?format<span class="token operator">=</span>json
<span class="token punctuation">{</span>
 <span class="token string">&quot;cursor&quot;</span><span class="token builtin class-name">:</span> 
<span class="token string">&quot;8/LoA0RGTABEissKgkAYRh2QiAh8FZVcuExKaWisxEbHTUzO7wVH7TKSb19Gi87ig8N3UIaeox/
IgdmjlQW0YLY7iICuhO9aIpHNJvWtLMXOKXGaqKUms0vPb8wXSSJCtyE7N3JP2ggfKCZRjHdxmq9
/eFc8Zndi0wJoeGY0PJLOq7lZVWJrJXFaee8JQ0fFjA+q6h9IVzAqTUOF3vEW/rq48RIueT90Cum
y78pvs3yABP6Ei+AK0Py7qm5huowPAAAA//8DAA==&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="`+A+'" alt="image-20230627194741920"></p><p>如果执行后，无任何结果返回，说明数据已经读取完毕</p><p><img src="'+L+'" alt="image-20230627194801315"></p><p>此时再次执行，会返回错误信息</p><p><img src="'+T+`" alt="image-20230627194820971"></p><p>如果关闭缓冲区，执行下面指令即可</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># 此处游标 cursor 值需要根据读者执行的操作进行修改，请勿直接使用</span>
POST _sql/close
<span class="token punctuation">{</span>
 <span class="token string">&quot;cursor&quot;</span><span class="token builtin class-name">:</span> 
<span class="token string">&quot;8/LoA0RGTABEissKgkAYRh2QiAh8FZVcuExKaWisxEbHTUzO7wVH7TKSb19Gi87ig8N3UIaeox/
IgdmjlQW0YLY7iICuhO9aIpHNJvWtLMXOKXGaqKUms0vPb8wXSSJCtyE7N3JP2ggfKCZRjHdxmq9
/eFc8Zndi0wJoeGY0PJLOq7lZVWJrJXFaee8JQ0fFjA+q6h9IVzAqTUOF3vEW/rq48RIueT90Cum
y78pvs3yABP6Ei+AK0Py7qm5huowPAAAA//8DAA==&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="`+B+`" alt="image-20230627194849357"></p><h4 id="基础聚合操作" tabindex="-1"><a class="header-anchor" href="#基础聚合操作" aria-hidden="true">#</a> 基础聚合操作</h4><p>在 ES 中使用 SQL 查询的聚合语法与在数据库中使用基本一致</p><ul><li>Min</li><li>Max</li><li>Avg</li><li>Sum</li><li>Count(*)</li><li>Distinct</li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>GET _sql?format<span class="token operator">=</span>txt
<span class="token punctuation">{</span>
  <span class="token string">&quot;query&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>&quot;
 SELECT 
 MIN<span class="token punctuation">(</span>page_count<span class="token punctuation">)</span> min, 
 MAX<span class="token punctuation">(</span>page_count<span class="token punctuation">)</span> max, 
 AVG<span class="token punctuation">(</span>page_count<span class="token punctuation">)</span> avg,
 SUM<span class="token punctuation">(</span>page_count<span class="token punctuation">)</span> sum,
 COUNT<span class="token punctuation">(</span>*<span class="token punctuation">)</span> count,
 COUNT<span class="token punctuation">(</span>DISTINCT name<span class="token punctuation">)</span> dictinct_count 
 FROM <span class="token string">&quot;my-sql-index&quot;</span> 
 <span class="token string">&quot;&quot;</span>&quot;
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="`+W+`" alt="image-20230627195137728"></p><h3 id="支持的函数和运算" tabindex="-1"><a class="header-anchor" href="#支持的函数和运算" aria-hidden="true">#</a> 支持的函数和运算</h3><h4 id="比较运算符" tabindex="-1"><a class="header-anchor" href="#比较运算符" aria-hidden="true">#</a> 比较运算符</h4><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># Equality</span>
SELECT * FROM <span class="token string">&quot;my-sql-index&quot;</span> WHERE name <span class="token operator">=</span> <span class="token string">&#39;JAVA&#39;</span>
<span class="token comment"># Null Safe Equality</span>
SELECT <span class="token string">&#39;elastic&#39;</span> <span class="token operator">&lt;=</span><span class="token operator">&gt;</span> null AS <span class="token string">&quot;equals&quot;</span>
SELECT null <span class="token operator">&lt;=</span><span class="token operator">&gt;</span> null AS <span class="token string">&quot;equals&quot;</span>
<span class="token comment"># Inequality</span>
SELECT * FROM <span class="token string">&quot;my-sql-index&quot;</span> WHERE name <span class="token operator">&lt;&gt;</span> <span class="token string">&#39;JAVA&#39;</span>
SELECT * FROM <span class="token string">&quot;my-sql-index&quot;</span> WHERE name <span class="token operator">!=</span> <span class="token string">&#39;JAVA&#39;</span>
<span class="token comment"># Comparison</span>
SELECT * FROM <span class="token string">&quot;my-sql-index&quot;</span> WHERE page_count <span class="token operator">&gt;</span> <span class="token number">500</span>
SELECT * FROM <span class="token string">&quot;my-sql-index&quot;</span> WHERE page_count <span class="token operator">&gt;=</span> <span class="token number">500</span>
SELECT * FROM <span class="token string">&quot;my-sql-index&quot;</span> WHERE page_count <span class="token operator">&lt;</span> <span class="token number">500</span>
SELECT * FROM <span class="token string">&quot;my-sql-index&quot;</span> WHERE page_count <span class="token operator">&lt;=</span> <span class="token number">500</span>
<span class="token comment"># BETWEEN</span>
SELECT * FROM <span class="token string">&quot;my-sql-index&quot;</span> WHERE page_count between <span class="token number">100</span> and <span class="token number">500</span>
<span class="token comment"># Is Null / Is Not Null</span>
SELECT * FROM <span class="token string">&quot;my-sql-index&quot;</span> WHERE name is not null
SELECT * FROM <span class="token string">&quot;my-sql-index&quot;</span> WHERE name is null
<span class="token comment"># IN</span>
SELECT * FROM <span class="token string">&quot;my-sql-index&quot;</span> WHERE name <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token string">&#39;JAVA&#39;</span>, <span class="token string">&#39;SCALA&#39;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="逻辑运算符" tabindex="-1"><a class="header-anchor" href="#逻辑运算符" aria-hidden="true">#</a> 逻辑运算符</h4><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># AND</span>
SELECT * FROM <span class="token string">&quot;my-sql-index&quot;</span> WHERE name <span class="token operator">=</span> <span class="token string">&#39;JAVA&#39;</span> AND page_count <span class="token operator">&gt;</span> <span class="token number">100</span>
<span class="token comment"># OR</span>
SELECT * FROM <span class="token string">&quot;my-sql-index&quot;</span> WHERE name <span class="token operator">=</span> <span class="token string">&#39;JAVA&#39;</span> OR name <span class="token operator">=</span> <span class="token string">&#39;SCALA&#39;</span>
<span class="token comment"># NOT</span>
SELECT * FROM <span class="token string">&quot;my-sql-index&quot;</span> WHERE NOT name <span class="token operator">=</span> <span class="token string">&#39;JAVA&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="数学运算符" tabindex="-1"><a class="header-anchor" href="#数学运算符" aria-hidden="true">#</a> 数学运算符</h4><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># 加减乘除</span>
<span class="token keyword">select</span> <span class="token number">1</span> + <span class="token number">1</span> as x
<span class="token keyword">select</span> <span class="token number">1</span> - <span class="token number">1</span> as x
<span class="token keyword">select</span> - <span class="token number">1</span> as x
<span class="token keyword">select</span> <span class="token number">6</span> * <span class="token number">6</span> as x
<span class="token keyword">select</span> <span class="token number">30</span> / <span class="token number">5</span> as x
<span class="token keyword">select</span> <span class="token number">30</span> % <span class="token number">7</span> as x
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="类型转换" tabindex="-1"><a class="header-anchor" href="#类型转换" aria-hidden="true">#</a> 类型转换</h4><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># 类型转换</span>
SELECT <span class="token string">&#39;123&#39;</span>::long AS long
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="模糊查询" tabindex="-1"><a class="header-anchor" href="#模糊查询" aria-hidden="true">#</a> 模糊查询</h4><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># LIKE 通配符</span>
SELECT * FROM <span class="token string">&quot;my-sql-index&quot;</span> WHERE name like <span class="token string">&#39;JAVA%&#39;</span>
SELECT * FROM <span class="token string">&quot;my-sql-index&quot;</span> WHERE name like <span class="token string">&#39;JAVA_&#39;</span>
<span class="token comment"># 如果需要匹配通配符本身,使用转义字符</span>
SELECT * FROM <span class="token string">&quot;my-sql-index&quot;</span> WHERE name like <span class="token string">&#39;JAVA/%&#39;</span> ESCAPE <span class="token string">&#39;/&#39;</span>
<span class="token comment"># RLIKE 不要误会，这里的 R 表示的不是方向，而是正则表示式 Regex</span>
SELECT * FROM <span class="token string">&quot;my-sql-index&quot;</span> WHERE name like <span class="token string">&#39;JAV*A&#39;</span>
SELECT * FROM <span class="token string">&quot;my-sql-index&quot;</span> WHERE name rlike <span class="token string">&#39;JAV*A&#39;</span>
<span class="token comment"># 尽管 LIKE在 Elasticsearch SQL 中搜索或过滤时是一个有效的选项，但全文搜索 MATCH 和 QUERY</span>
速度更快、功能更强大，并且是首选替代方案。
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="聚合分析函数" tabindex="-1"><a class="header-anchor" href="#聚合分析函数" aria-hidden="true">#</a> 聚合分析函数</h4><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># FIRST / FIRST_VALUE : FIRST(第一个字段，排序字段)</span>
SELECT first<span class="token punctuation">(</span>name, release_date<span class="token punctuation">)</span> FROM <span class="token string">&quot;my-sql-index&quot;</span>
SELECT first_value<span class="token punctuation">(</span>substring<span class="token punctuation">(</span>name,2,1<span class="token punctuation">))</span> FROM <span class="token string">&quot;my-sql-index&quot;</span>
<span class="token comment"># LAST / LAST_VALUE : LAST (第一个字段，排序字段)</span>
SELECT last<span class="token punctuation">(</span>name, release_date<span class="token punctuation">)</span> FROM <span class="token string">&quot;my-sql-index&quot;</span>
SELECT last_value<span class="token punctuation">(</span>substring<span class="token punctuation">(</span>name,2,1<span class="token punctuation">))</span> FROM <span class="token string">&quot;my-sql-index&quot;</span>
<span class="token comment"># KURTOSIS 量化字段的峰值分布</span>
SELECT KURTOSIS<span class="token punctuation">(</span>page_count<span class="token punctuation">)</span> FROM <span class="token string">&quot;my-sql-index&quot;</span>
<span class="token comment"># MAD</span>
SELECT MAD<span class="token punctuation">(</span>page_count<span class="token punctuation">)</span> FROM <span class="token string">&quot;my-sql-index&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="分组函数" tabindex="-1"><a class="header-anchor" href="#分组函数" aria-hidden="true">#</a> 分组函数</h4><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># HISTOGRAM : 直方矩阵</span>
SELECT HISTOGRAM<span class="token punctuation">(</span>page_count, <span class="token number">100</span><span class="token punctuation">)</span> as c， count<span class="token punctuation">(</span>*<span class="token punctuation">)</span> FROM <span class="token string">&quot;my-sql-index&quot;</span> group by 
c
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="数学通用函数" tabindex="-1"><a class="header-anchor" href="#数学通用函数" aria-hidden="true">#</a> 数学通用函数</h4><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># ABS：求数字的绝对值</span>
<span class="token keyword">select</span> ABS<span class="token punctuation">(</span>page_count<span class="token punctuation">)</span> from <span class="token string">&quot;myindex&quot;</span> limit <span class="token number">5</span>
<span class="token comment"># CBRT：求数字的立方根，返回 double</span>
<span class="token keyword">select</span> page_count v,CBRT<span class="token punctuation">(</span>page_count<span class="token punctuation">)</span> cbrt from <span class="token string">&quot;myindex&quot;</span> limit <span class="token number">5</span>
<span class="token comment"># CEIL：返回大于或者等于指定表达式最小整数（double）</span>
<span class="token keyword">select</span> page_count v,CEIL<span class="token punctuation">(</span>page_count<span class="token punctuation">)</span> from <span class="token string">&quot;myindex&quot;</span> limit <span class="token number">5</span>
<span class="token comment"># CEILING：等同于 CEIL</span>
<span class="token keyword">select</span> page_count v,CEILING<span class="token punctuation">(</span>page_count<span class="token punctuation">)</span> from <span class="token string">&quot;myindex&quot;</span> limit <span class="token number">5</span>
<span class="token comment"># E：返回自然常数 e(2.718281828459045)</span>
<span class="token keyword">select</span> page_count,E<span class="token punctuation">(</span>page_count<span class="token punctuation">)</span> from <span class="token string">&quot;myindex&quot;</span> limit <span class="token number">5</span>
<span class="token comment"># ROUND：四舍五入精确到个位</span>
<span class="token keyword">select</span> ROUND<span class="token punctuation">(</span>-3.14<span class="token punctuation">)</span>
<span class="token comment"># FLOOR：向下取整</span>
<span class="token keyword">select</span> FLOOR<span class="token punctuation">(</span><span class="token number">3.14</span><span class="token punctuation">)</span>
<span class="token comment"># LOG：计算以 2 为底的自然对数</span>
<span class="token keyword">select</span> LOG<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>
<span class="token comment"># LOG10：计算以 10 为底的自然对数</span>
<span class="token keyword">select</span> LOG10<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>
<span class="token comment"># SQRT：求一个非负实数的平方根</span>
<span class="token keyword">select</span> SQRT<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span>
<span class="token comment"># EXP：此函数返回 e(自然对数的底)的 X 次方的值</span>
<span class="token keyword">select</span> EXP<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="三角函数" tabindex="-1"><a class="header-anchor" href="#三角函数" aria-hidden="true">#</a> 三角函数</h4><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># DEGREES：返回 X 从弧度转换为度值</span>
<span class="token keyword">select</span> DEGREES<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
<span class="token comment"># RADIANS：返回 X 从度转换成弧度的值</span>
<span class="token keyword">select</span> RADIANS<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
<span class="token comment"># SIN：返回 X 的正弦</span>
<span class="token keyword">select</span> SIN<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
<span class="token comment"># COS：返回 X，X 值是以弧度给出的余弦值</span>
<span class="token keyword">select</span> COS<span class="token punctuation">(</span>角度<span class="token punctuation">)</span>
<span class="token comment"># TAN：返回参数 X，表示以弧度的切线值</span>
<span class="token keyword">select</span> TAN<span class="token punctuation">(</span>角度<span class="token punctuation">)</span>
<span class="token comment"># ASIN：返回 X 的反正弦，X 的值必须在-1 至 1 范围内，返回 NULL</span>
<span class="token keyword">select</span> ASIN<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
<span class="token comment"># ACOS：返回 X 的反正弦，X 值必须-1 到 1 之间范围否则将返回 NULL</span>
<span class="token keyword">select</span> ACOS<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
<span class="token comment"># ATAN：返回 X 的反正切</span>
<span class="token keyword">select</span> ATAN<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
<span class="token comment"># SINH：返回 X 的双曲正弦值</span>
<span class="token keyword">select</span> SINH<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
<span class="token comment"># COSH：返回 X 的双曲余弦值</span>
<span class="token keyword">select</span> COSH<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="日期时间函数" tabindex="-1"><a class="header-anchor" href="#日期时间函数" aria-hidden="true">#</a> 日期时间函数</h4><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># YEAR：</span>
SELECT YEAR<span class="token punctuation">(</span>CAST<span class="token punctuation">(</span><span class="token string">&#39;2022-05-01T00:00:00Z&#39;</span> AS TIMESTAMP<span class="token punctuation">))</span> AS year
<span class="token comment"># MONTH_OF_YEAR() or MONTH()：</span>
SELECT MONTH<span class="token punctuation">(</span>CAST<span class="token punctuation">(</span><span class="token string">&#39;2022-05-01T00:00:00Z&#39;</span> AS TIMESTAMP<span class="token punctuation">))</span> AS month
<span class="token comment"># WEEK_OF_YEAR() or WEEK()：</span>
SELECT WEEK<span class="token punctuation">(</span>CAST<span class="token punctuation">(</span><span class="token string">&#39;2022-05-01T00:00:00Z&#39;</span> AS TIMESTAMP<span class="token punctuation">))</span> AS week
<span class="token comment"># DAY_OF_YEAR() or DOY() ，效果等同于 EXTRACT(&lt;datetime_function&gt; FROM </span>
<span class="token operator">&lt;</span>expression<span class="token operator">&gt;</span><span class="token punctuation">)</span>：
SELECT DOY<span class="token punctuation">(</span>CAST<span class="token punctuation">(</span><span class="token string">&#39;2022-05-01T00:00:00Z&#39;</span> AS TIMESTAMP<span class="token punctuation">))</span> AS day
<span class="token comment"># DAY_OF_MONTH(), DOM(), or DAY()：</span>
SELECT DAY<span class="token punctuation">(</span>CAST<span class="token punctuation">(</span><span class="token string">&#39;2022-05-01T00:00:00Z&#39;</span> AS TIMESTAMP<span class="token punctuation">))</span> AS day
<span class="token comment"># DAY_OF_WEEK() or DOW()：</span>
SELECT DOW<span class="token punctuation">(</span>CAST<span class="token punctuation">(</span><span class="token string">&#39;2022-05-01T00:00:00Z&#39;</span> AS TIMESTAMP<span class="token punctuation">))</span> AS day
<span class="token comment"># HOUR_OF_DAY() or HOUR()：</span>
SELECT HOUR<span class="token punctuation">(</span>CAST<span class="token punctuation">(</span><span class="token string">&#39;2022-05-01T00:00:00Z&#39;</span> AS TIMESTAMP<span class="token punctuation">))</span> AS hour
<span class="token comment"># MINUTE_OF_DAY()：</span>
SELECT MINUTE_OF_DAY<span class="token punctuation">(</span>CAST<span class="token punctuation">(</span><span class="token string">&#39;2022-05-01T00:00:00Z&#39;</span> AS TIMESTAMP<span class="token punctuation">))</span> AS minute
<span class="token comment"># MINUTE_OF_HOUR() or MINUTE()：</span>
SELECT MINUTE<span class="token punctuation">(</span>CAST<span class="token punctuation">(</span><span class="token string">&#39;2022-05-01T00:00:00Z&#39;</span> AS TIMESTAMP<span class="token punctuation">))</span> AS minute
<span class="token comment"># SECOND_OF_MINUTE() or SECOND()：</span>
SELECT SECOND<span class="token punctuation">(</span>CAST<span class="token punctuation">(</span><span class="token string">&#39;2022-05-01T00:00:00Z&#39;</span> AS TIMESTAMP<span class="token punctuation">))</span> AS second
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="全文搜索函数" tabindex="-1"><a class="header-anchor" href="#全文搜索函数" aria-hidden="true">#</a> 全文搜索函数</h4><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># MATCH：MATCH(匹配字段，规则, 配置参数(可选))</span>
SELECT * FROM <span class="token string">&quot;my-sql-index&quot;</span> where MATCH<span class="token punctuation">(</span>name, <span class="token string">&#39;JAVA&#39;</span><span class="token punctuation">)</span>
SELECT * FROM <span class="token string">&quot;my-sql-index&quot;</span> where MATCH<span class="token punctuation">(</span>name, <span class="token string">&#39;java&#39;</span><span class="token punctuation">)</span>
<span class="token comment"># MATCH：MATCH((&#39;匹配字段^权重 1,匹配字段^权重 2&#39;，规则, 配置参数(可选))</span>
SELECT * FROM <span class="token string">&quot;my-sql-index&quot;</span> where MATCH<span class="token punctuation">(</span><span class="token string">&#39;author^2,name^5&#39;</span>, <span class="token string">&#39;java&#39;</span><span class="token punctuation">)</span>
<span class="token comment"># QUERY</span>
SELECT * FROM <span class="token string">&quot;my-sql-index&quot;</span> where QUERY<span class="token punctuation">(</span><span class="token string">&#39;name:Java&#39;</span><span class="token punctuation">)</span>
<span class="token comment"># SCORE : 评分</span>
SELECT *, score<span class="token punctuation">(</span><span class="token punctuation">)</span> FROM <span class="token string">&quot;my-sql-index&quot;</span> where QUERY<span class="token punctuation">(</span><span class="token string">&#39;name:Java&#39;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="字符串检索函数" tabindex="-1"><a class="header-anchor" href="#字符串检索函数" aria-hidden="true">#</a> 字符串检索函数</h4><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># ASCII : 字符串转成 ASC 码</span>
SELECT ASCII<span class="token punctuation">(</span><span class="token string">&#39;Elastic&#39;</span><span class="token punctuation">)</span>
<span class="token comment"># BIT_LENGTH ： 位长度</span>
SELECT BIT_LENGTH<span class="token punctuation">(</span><span class="token string">&#39;Elastic&#39;</span><span class="token punctuation">)</span>
SELECT BIT_LENGTH<span class="token punctuation">(</span><span class="token string">&#39;中国&#39;</span><span class="token punctuation">)</span>
<span class="token comment"># CHAR ：转换字符</span>
SELECT CHAR<span class="token punctuation">(</span><span class="token number">69</span><span class="token punctuation">)</span>
<span class="token comment"># CHAR_LENGTH ：字符长度</span>
SELECT CHAR_LENGTH<span class="token punctuation">(</span><span class="token string">&#39;Elastic&#39;</span><span class="token punctuation">)</span>
<span class="token comment"># CONCAT:合并</span>
SELECT CONCAT<span class="token punctuation">(</span><span class="token string">&#39;Elastic&#39;</span>, <span class="token string">&#39;search&#39;</span><span class="token punctuation">)</span>
<span class="token comment"># INSERT : INSERT(字符串，起始位置，长度，插入的内容)</span>
SELECT INSERT<span class="token punctuation">(</span><span class="token string">&#39;Elastic&#39;</span>, <span class="token number">8</span>, <span class="token number">1</span>, <span class="token string">&#39;search&#39;</span><span class="token punctuation">)</span>
SELECT INSERT<span class="token punctuation">(</span><span class="token string">&#39;Elastic&#39;</span>, <span class="token number">7</span>, <span class="token number">1</span>, <span class="token string">&#39;search&#39;</span><span class="token punctuation">)</span>
<span class="token comment"># LCASE ：转换小写</span>
SELECT LCASE<span class="token punctuation">(</span><span class="token string">&#39;Elastic&#39;</span><span class="token punctuation">)</span>
<span class="token comment"># LEFT : 获取左边最多 N 个字符</span>
SELECT LEFT<span class="token punctuation">(</span><span class="token string">&#39;Elastic&#39;</span>,3<span class="token punctuation">)</span>
<span class="token comment"># LENGTH</span>
SELECT length<span class="token punctuation">(</span><span class="token string">&#39;Elastic&#39;</span><span class="token punctuation">)</span>
SELECT length<span class="token punctuation">(</span><span class="token string">&#39;中国&#39;</span><span class="token punctuation">)</span>
<span class="token comment"># LOCATE : LOCATE(表达式，字符串，起始位置)，获取满足条件的位置</span>
SELECT LOCATE<span class="token punctuation">(</span><span class="token string">&#39;a&#39;</span>, <span class="token string">&#39;Elasticsearch&#39;</span><span class="token punctuation">)</span>
SELECT LOCATE<span class="token punctuation">(</span><span class="token string">&#39;a&#39;</span>, <span class="token string">&#39;Elasticsearch&#39;</span>, <span class="token number">5</span><span class="token punctuation">)</span>
<span class="token comment"># LTRIM ：去除左边的空格</span>
SELECT LTRIM<span class="token punctuation">(</span><span class="token string">&#39; Elastic&#39;</span><span class="token punctuation">)</span>
<span class="token comment"># OCTET_LENGTH : 字节长度</span>
SELECT OCTET_LENGTH<span class="token punctuation">(</span><span class="token string">&#39;Elastic&#39;</span><span class="token punctuation">)</span>
SELECT OCTET_LENGTH<span class="token punctuation">(</span><span class="token string">&#39;中国&#39;</span><span class="token punctuation">)</span>
<span class="token comment"># POSITION ：获取指定字符串的位置</span>
SELECT POSITION<span class="token punctuation">(</span><span class="token string">&#39;Elastic&#39;</span>, <span class="token string">&#39;Elasticsearch&#39;</span><span class="token punctuation">)</span>
<span class="token comment"># REPEAT ：将字符串重复指定次数</span>
SELECT REPEAT<span class="token punctuation">(</span><span class="token string">&#39;Elastic&#39;</span>, <span class="token number">3</span><span class="token punctuation">)</span>
<span class="token comment"># REPLACE ：替换数据</span>
SELECT REPLACE<span class="token punctuation">(</span><span class="token string">&#39;Elastic&#39;</span>,<span class="token string">&#39;El&#39;</span>,<span class="token string">&#39;Fant&#39;</span><span class="token punctuation">)</span>
<span class="token comment"># RIGHT ：从右边获取指定数量的数据</span>
SELECT RIGHT<span class="token punctuation">(</span><span class="token string">&#39;Elastic&#39;</span>,3<span class="token punctuation">)</span>
<span class="token comment"># RTRIM ：去除右边的空格</span>
SELECT RTRIM<span class="token punctuation">(</span><span class="token string">&#39;Elastic &#39;</span><span class="token punctuation">)</span>
<span class="token comment"># SPACE : 生成指定数量的空格</span>
SELECT concat<span class="token punctuation">(</span>SPACE<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>,<span class="token string">&#39;abc&#39;</span><span class="token punctuation">)</span>
<span class="token comment"># STARTS_WITH : 判断是否以指定字符串开头</span>
SELECT STARTS_WITH<span class="token punctuation">(</span><span class="token string">&#39;Elasticsearch&#39;</span>, <span class="token string">&#39;Elastic&#39;</span><span class="token punctuation">)</span>
<span class="token comment"># SUBSTRING ： 截取字符串，必须传递三个参数</span>
SELECT SUBSTRING<span class="token punctuation">(</span><span class="token string">&#39;Elasticsearch&#39;</span>, <span class="token number">0</span>, <span class="token number">7</span><span class="token punctuation">)</span>
<span class="token comment"># TRIM ：去掉首尾空格</span>
SELECT TRIM<span class="token punctuation">(</span><span class="token string">&#39; Elastic &#39;</span><span class="token punctuation">)</span> AS trimmed
<span class="token comment"># UCASE : 转换大写</span>
SELECT UCASE<span class="token punctuation">(</span><span class="token string">&#39;Elastic&#39;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="条件分支函数" tabindex="-1"><a class="header-anchor" href="#条件分支函数" aria-hidden="true">#</a> 条件分支函数</h4><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># 多重分支判断</span>
SELECT CASE <span class="token number">5</span>
 WHEN <span class="token number">1</span> THEN <span class="token string">&#39;elastic&#39;</span>
 WHEN <span class="token number">2</span> THEN <span class="token string">&#39;search&#39;</span>
 WHEN <span class="token number">3</span> THEN <span class="token string">&#39;elasticsearch&#39;</span>
 ELSE <span class="token string">&#39;default&#39;</span>
 END AS <span class="token string">&quot;case&quot;</span>
SELECT CASE WHEN <span class="token number">1</span> <span class="token operator">&gt;</span> <span class="token number">2</span> THEN <span class="token string">&#39;elastic&#39;</span>
 WHEN <span class="token number">2</span> <span class="token operator">&gt;</span> <span class="token number">10</span> THEN <span class="token string">&#39;search&#39;</span>
 ELSE <span class="token string">&#39;default&#39;</span>
 END AS <span class="token string">&quot;case&quot;</span>
<span class="token comment"># IFNULL</span>
SELECT IFNULL<span class="token punctuation">(</span><span class="token string">&#39;elastic&#39;</span>, null<span class="token punctuation">)</span> AS <span class="token string">&quot;ifnull&quot;</span>
SELECT IFNULL<span class="token punctuation">(</span>null, <span class="token string">&#39;search&#39;</span><span class="token punctuation">)</span> AS <span class="token string">&quot;ifnull&quot;</span>
<span class="token comment"># IIF</span>
SELECT IIF<span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">&lt;</span> <span class="token number">2</span>, <span class="token string">&#39;TRUE&#39;</span>, <span class="token string">&#39;FALSE&#39;</span><span class="token punctuation">)</span> AS result1, IIF<span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">&gt;</span> <span class="token number">2</span>, <span class="token string">&#39;TRUE&#39;</span>, <span class="token string">&#39;FALSE&#39;</span><span class="token punctuation">)</span> AS 
result2
<span class="token comment"># ISNULL</span>
SELECT ISNULL<span class="token punctuation">(</span><span class="token string">&#39;elastic&#39;</span>, null<span class="token punctuation">)</span> AS <span class="token string">&quot;isnull&quot;</span>
SELECT ISNULL<span class="token punctuation">(</span>null, <span class="token string">&#39;search&#39;</span><span class="token punctuation">)</span> AS <span class="token string">&quot;isnull&quot;</span>
<span class="token comment"># LEAST:获取除 null 外的最小值</span>
SELECT LEAST<span class="token punctuation">(</span>null, <span class="token number">2</span>, <span class="token number">11</span><span class="token punctuation">)</span> AS <span class="token string">&quot;least&quot;</span>
SELECT LEAST<span class="token punctuation">(</span>null, null, null, null<span class="token punctuation">)</span> AS <span class="token string">&quot;least&quot;</span>
<span class="token comment"># NULLIF : 如果两个字符串不相同，则返回第一个字符串，如果相同，返回 null</span>
SELECT NULLIF<span class="token punctuation">(</span><span class="token string">&#39;elastic&#39;</span>, <span class="token string">&#39;search&#39;</span><span class="token punctuation">)</span> AS <span class="token string">&quot;nullif&quot;</span>
SELECT NULLIF<span class="token punctuation">(</span><span class="token string">&#39;elastic&#39;</span>, <span class="token string">&#39;elastic&#39;</span><span class="token punctuation">)</span> AS <span class="token string">&quot;nullif&quot;</span>
<span class="token comment"># NVL : 返回第一个不是 null 的字符串，如果都是 null,那么返回 Null</span>
SELECT NVL<span class="token punctuation">(</span><span class="token string">&#39;elastic&#39;</span>, null<span class="token punctuation">)</span> AS <span class="token string">&quot;nvl&quot;</span>
SELECT NVL<span class="token punctuation">(</span>null, null<span class="token punctuation">)</span> AS <span class="token string">&quot;nvl&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="系统函数" tabindex="-1"><a class="header-anchor" href="#系统函数" aria-hidden="true">#</a> 系统函数</h4><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># ES 集群</span>
SELECT DATABASE<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 用户</span>
SELECT <span class="token environment constant">USER</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="sql客户端-datagrip" tabindex="-1"><a class="header-anchor" href="#sql客户端-datagrip" aria-hidden="true">#</a> SQL客户端-DataGrip</h3><p>DataGrip 是 JetBrains 发布的多引擎数据库环境, 这里采用 DataGrip 工具连接 Elasticsearch</p><p><img src="`+I+'" alt="image-20230627195955795"></p><p>1.新建驱动</p><p><img src="'+R+`" alt="image-20230627200058183"></p><p>2.配置驱动</p><p>可以先通过 maven 增加依赖，下载驱动程序</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.elasticsearch.plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>x-pack-sql-jdbc<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>8.1.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>配置驱动时，选择对应的 ES 软件版本即可</p><p><img src="`+F+`" alt="image-20230627200140265"></p><p>3.配置参数</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># 用户名和账号采用 ES 自带的 elastic 即可</span>
<span class="token comment"># URL 地址</span>
jdbc:es://https://linux1:9200
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="`+M+'" alt="image-20230627200234314"></p><p>4.配置SSL连接</p><p>选择 Elasticseach 生成的证书即可</p><p><img src="'+O+'" alt="image-20230627200316046"></p><p>5.更改license类型</p><p>默认情况下，JDBC 客户端必须为白金级别才可以使用</p><p><img src="'+N+'" alt="image-20230627200352203"></p><p>当前使用的 License 为 basic</p><p><img src="'+H+`" alt="image-20230627200429053"></p><p>为了能够使用相关功能，这里可以将当前的 ES 软件的 License 暂时设置为试用版。测试完成后，改回 basic 版即可</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># 更改 License 类型 - trial</span>
POST _license/start_trial?acknowledge<span class="token operator">=</span>true
<span class="token comment"># 更改 License 类型 - basic</span>
POST _license/start_basic?acknowledge<span class="token operator">=</span>true
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="`+P+'" alt="image-20230627200457514"></p><p>6.执行SQL操作</p><p><img src="'+D+'" alt="image-20230627200545987"></p><p><img src="'+U+'" alt="image-20230627200557236"></p><h2 id="四、自然语言处理nlp" tabindex="-1"><a class="header-anchor" href="#四、自然语言处理nlp" aria-hidden="true">#</a> 四、自然语言处理NLP</h2><p>随着 8.0 的发布，Elastic 很高兴能够将 PyTorch 机器学习模型上传到 Elasticsearch 中，以在 Elastic Stack 中提供现代自然语言处理 (NLP)。现在，Elasticsearch 用户能够集成用于构建 NLP 模型的最流行的格式之一，并将这些模型作为 NLP 数据管道的一部分通过我们的Inference processor 整合到 Elasticsearch 中</p><h3 id="什么是自然语言处理" tabindex="-1"><a class="header-anchor" href="#什么是自然语言处理" aria-hidden="true">#</a> 什么是自然语言处理？</h3><p>NLP 是指我们可以使用软件来操作和理解口语或书面文本或自然语言的方式。 2018 年，Google 开源了一种用于 NLP 预训练的新技术，称为来自 Transformers 的双向编码器呈现，或 BERT。 BERT 通过在没有任何人工参与的情况下对互联网大小的数据集（例如，想想所有的维基百科和数字书籍）进行训练来利用 “transfer learning”。</p><p>Transfer learning 允许对 BERT 模型进行预训练以进行通用语言理解。一旦模型只经过一次预训练，它就可以被重用并针对更具体的任务进行微调，以了解语言的使用方式。为了支持类 BERT 模型（使用与 BERT 相同的标记器的模型），Elasticsearch 将首先通过 PyTorch 模型支持支持大多数最常见的 NLP 任务。 PyTorch 是最受欢迎的现代机器学习库之一，拥有大量活跃用户，它是一个支持深度神经网络的库，例如 BERT 使用的Transformer 架构。</p><p>以下是一些示例 NLP 任务：</p><ul><li><p>情绪分析：用于识别正面与负面陈述的二元分类</p></li><li><p>命名实体识别 (NER)：从非结构化文本构建结构，尝试提取名称、位置或组织等细节</p></li><li><p>文本分类：零样本分类允许你根据你选择的类对文本进行分类，而无需进行预训练。</p></li><li><p>文本嵌入：用于 k 近邻 (kNN) 搜索</p></li></ul><h3 id="elasticsearch-中的自然语言处理" tabindex="-1"><a class="header-anchor" href="#elasticsearch-中的自然语言处理" aria-hidden="true">#</a> <strong>Elasticsearch</strong> <strong>中的自然语言处理</strong></h3><p>在将 NLP 模型集成到 Elastic 平台时，我们希望为上传和管理模型提供出色的用户体验。使用用于上传 PyTorch 模型的 Eland 客户端和用于管理 Elasticsearch 集群上模型的Kibana 的 ML 模型管理用户界面，用户可以尝试不同的模型并很好地了解它们在数据上的表现。我们还希望使其可跨集群中的多个可用节点进行扩展，并提供良好的推理吞吐量性能。</p><p>为了使这一切成为可能，我们需要一个机器学习库来执行推理。在 Elasticsearch 中添加对 PyTorch 的支持需要使用原生库 libtorch，它支持 PyTorch，并且仅支持已导出或保存为 TorchScript 表示的 PyTorch 模型。这是 libtorch 需要的模型的表示，它将允许Elasticsearch 避免运行 Python 解释器。</p><p><img src="'+K+'" alt="image-20230627201039508"></p><p>通过与在 PyTorch 模型中构建 NLP 模型的最流行的格式之一集成，Elasticsearch 可以提供一个平台，该平台可处理大量 NLP 任务和用例。许多优秀的库可用于训练 NLP 模型，因此我们暂时将其留给其他工具。无论你是使用 PyTorch NLP、Hugging Face Transformers 还 是 Facebook 的 fairseq 等库来训练模型，你都可以将模型导入 Elasticsearch 并对这些模型进行推理。 Elasticsearch 推理最初将仅在摄取时进行，未来还可以扩展以在查询时引入推理。</p><h3 id="nlp-在-elasticsearch-7-x-和-8-x-中的区别" tabindex="-1"><a class="header-anchor" href="#nlp-在-elasticsearch-7-x-和-8-x-中的区别" aria-hidden="true">#</a> <strong>NLP</strong> <strong>在</strong> <strong>Elasticsearch 7.x</strong> <strong>和</strong> <strong>8.x</strong> <strong>中的区别</strong></h3><p>Elasticsearch 一直是进行 NLP 的好地方，但从历史上看，它需要在 Elasticsearch 之外进行一些处理，或者编写一些非常复杂的插件。 借助 8.0，用户现在可以在 Elasticsearch 中更直接地执行命名实体识别、情感分析、文本分类等操作——无需额外的组件或编码。 不仅在 Elasticsearch 中本地计算和创建向量在水平可扩展性方面是“胜利”（通过在服务器集群中分布计算）——这一变化还为 Elasticsearch 用户节省了大量时间和精力。</p><p><img src="'+j+'" alt="image-20230627201130057"></p><p>借助 Elastic 8.0，用户可以直接在 Elasticsearch 中使用 PyTorch 机器学习模型（例如 BERT），并在 Elasticsearch 中使用这些模型进行推理。通过使用户能够直接在 Elasticsearch 中执行推理，将现代 NLP 的强大功能集成到搜索应用程序和体验、本质上更高效（得益于 Elasticsearch 的分布式计算能力）和 NLP 本身比以往任何时候都更容易 变得更快，因为你不需要将数据移出到单独的进程或系统中。</p><h3 id="nlp-演示" tabindex="-1"><a class="header-anchor" href="#nlp-演示" aria-hidden="true">#</a> <strong>NLP</strong> <strong>演示</strong></h3>',238),z={href:"https://github.com/spinscale/elasticsearch-ingest-opennlp/releases/tag/8.1.1.1",target:"_blank",rel:"noopener noreferrer"},$=a('<p>来进行演示。<strong>我们必须安装和自己的</strong> <strong>Elasticsearch</strong> <strong>一致的版本。</strong></p><p><img src="'+G+'" alt="image-20230627201242642"></p><p>目前这个 NLP 支持检测 Date， Person， Location, POS (part of speech) 及其它。</p><p>1.安装opennlp</p><p>将下载下来的插件上传到<strong>所有</strong> <strong>ES</strong> <strong>服务器节点</strong>的 plugins 路径中。</p><p><img src="'+Q+`" alt="image-20230627201325524"></p><p>2.下载NER模型</p><p>我们需要从 sourceforge 下载最新的 NER 模型</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>bin/ingest-opennlp/download-models
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>执行时，可能会提示脚本路径不对等问题。直接修改脚本文件改正即可</p><p><img src="`+V+'" alt="image-20230627201418691"></p><p>执行后，会出现如下内容</p><p><img src="'+J+`" alt="image-20230627201435589"></p><p>3.配置opennlp</p><p>修改配置文件：config/elasticsearch.yml</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">ingest.opennlp.model.file.persons</span><span class="token punctuation">:</span> en<span class="token punctuation">-</span>ner<span class="token punctuation">-</span>persons.bin
<span class="token key atrule">ingest.opennlp.model.file.dates</span><span class="token punctuation">:</span> en<span class="token punctuation">-</span>ner<span class="token punctuation">-</span>dates.bin
<span class="token key atrule">ingest.opennlp.model.file.locations</span><span class="token punctuation">:</span> en<span class="token punctuation">-</span>ner<span class="token punctuation">-</span>locations.bin
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>重新启动</strong> <strong>Elasticsearch</strong></p><p>4.运用opennlp</p><p>创建一个支持 NLP 的 pipeline</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>PUT _ingest/pipeline/opennlp-pipeline
<span class="token punctuation">{</span>
  <span class="token string">&quot;description&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;A pipeline to do named entity extraction&quot;</span>,
  <span class="token string">&quot;processors&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token string">&quot;opennlp&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;field&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;message&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>增加数据</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>PUT my-nlp-index
PUT my-nlp-index/_doc/1?pipeline<span class="token operator">=</span>opennlp-pipeline
<span class="token punctuation">{</span>
 <span class="token string">&quot;message&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;Shay Banon announced the release of Elasticsearch 6.0 in November 
2017&quot;</span>
<span class="token punctuation">}</span>
PUT my-nlp-index/_doc/2?pipeline<span class="token operator">=</span>opennlp-pipeline
<span class="token punctuation">{</span>
 <span class="token string">&quot;message&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;Kobe Bryant was one of the best basketball players of all times. 
Not even Michael Jordan has ever scored 81 points in one game. Munich is really 
an awesome city, but New York is as well. Yesterday has been the hottest day of 
the year.&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>查看数据</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>GET my-nlp-index/_doc/1
GET my-nlp-index/_doc/2
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>从结果我们可以看出来，它正确地识别了 dates，persons 及 locations。</p><p><img src="`+X+'" alt="image-20230627201834801"></p>',26);function ss(ns,as){const t=u("ExternalLinkIcon");return o(),e("div",null,[Y,s("p",null,[n("这里我们使用 "),s("a",z,[n("https://github.com/spinscale/elasticsearch-ingest-opennlp/releases/tag/8.1.1.1"),c(t)])]),$])}const os=p(Z,[["render",ss],["__file","4、Elasticsearch进阶功能.html.vue"]]);export{os as default};
